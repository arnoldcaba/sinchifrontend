(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0af0a7"],{"0d41":function(e,o,t){"use strict";t.r(o);var i=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("v-container",{attrs:{fluid:""}},[t("v-card",{attrs:{flat:"",tile:""}},[t("v-card-text",[t("v-data-table",{attrs:{headers:e.headersobjetivos,items:e.objetivos,"items-per-page":5},scopedSlots:e._u([{key:"item.descripcion",fn:function(o){var i=o.item;return[t("v-textarea",{attrs:{filled:"",name:"input-5-4",readonly:e.readonly},model:{value:i.descripcion,callback:function(o){e.$set(i,"descripcion",o)},expression:"item.descripcion"}})]}},{key:"item.peso",fn:function(o){var i=o.item;return[t("v-text-field",{attrs:{type:"number",readonly:e.readonly,min:"0",rules:[e.rules.maxPorcentaje],suffix:"%"},model:{value:i.peso,callback:function(o){e.$set(i,"peso",o)},expression:"item.peso"}})]}},{key:"item.action",fn:function(o){var i=o.item;return[t("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.readonly&&0!=i.codigoreal,expression:"!readonly && item.codigoreal != 0"}],staticClass:"mr-5",attrs:{small:"",color:"primary",disabled:e.loading,loading:e.loading},on:{click:function(o){e.dialog_del=!0,e.itemactual=i}}},[e._v("\n                        delete\n                    ")])]}}])})],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.readonly,expression:"!readonly"}],attrs:{color:"primary",text:""},on:{click:e.saveitem}},[e._v("Guardar Objetivos")])],1)],1),t("v-dialog",{attrs:{width:"550"},model:{value:e.dialog_del,callback:function(o){e.dialog_del=o},expression:"dialog_del"}},[t("v-card",[t("v-card-title",[t("span",{staticClass:"headline red--text"},[e._v("Eliminar Objetivo")])]),t("v-card-text",[e._v("\t\t\t\t\t\n                ¿Esta seguro de eliminar el Objetivo seleccionado?. Está acción eliminará tambien los productos asociados al objetivo\n                y a su vez, las actividades asociadas a los productos de dicho objetivo.\t\t\t\t\t\n            ")]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"primary",dark:"",text:""},on:{click:function(o){e.dialog_del=!1}}},[e._v("Cancelar")]),t("v-btn",{attrs:{color:"red",text:""},on:{click:e.deleteItem}},[e._v("Eliminar")])],1)],1)],1)],1)},a=[],r=t("c088"),s={name:"Objetivos",props:["proyecto","readonly","convenioproyecto","nombreproyecto","codigocoordinador"],data:function(){return{loading:!1,dialog_del:!1,itemactual:"",objetivos:[{codigo:0,descripcion:"",peso:0,codigoreal:0}],headersobjetivos:[{text:"No.",value:"codigo",sortable:!1,align:"left",width:"10%"},{text:"Descripción",align:"left",sortable:!1,value:"descripcion",width:"70%"},{text:"Peso",value:"peso",sortable:!1,align:"left",width:"10%"},{text:"Accion",value:"action",sortable:!1,align:"left",width:"10%"}],rules:{maxPorcentaje:function(e){return e<100||"El % del Peso no puede superar el 100%"}}}},methods:{showMessage:function(e,o,t,i){this.$root.$emit("showSnack",{snack:e,time:o,color:t,text:i})},envioNotificaciones:function(e,o,t){this.$emit("envioNotificaciones",{mensajenotificacion:e,asuntocorreo:o,mensajecorreo:t})},ObjetivosVacios:function(){var e=0;for(this.objetivos=[],e;e<30;e++)this.objetivos.push({codigo:e+1,proyecto:"",descripcion:"",codigoreal:0,peso:0})},traerObjetivos:function(e){var o=this;this.loading=!0,r["a"].BuscarXProyecto(e).then((function(e){if(e.request)if(e.data){o.objetivos=e.data.data;for(var t=o.objetivos.length,i=t;i<30;i++)o.objetivos.push({codigo:i+1,proyecto:"",descripcion:"",codigoreal:0,peso:0})}else o.objetivos=[],o.ObjetivosVacios();else o.objetivos=[],o.ObjetivosVacios();o.loading=!1})).catch((function(e){o.objetivos=[],o.ObjetivosVacios(),o.loading=!1}))},deleteItem:function(){var e=this;this.loading=!0,r["a"].DelData(e.itemactual.codigo,e.proyecto).then((function(o){if(o.statusText){e.showMessage(!0,3e3,"success","Se eliminó el Objetivo con éxito"),e.del_item="",e.traerObjetivos(e.proyecto),e.dialog_del=!1,e.OnOffProyObjetivo(),e.agregaBitacora("ELIMINACION","SE ELIMINÓ EL OBJETIVO CON CODIGO:"+e.itemactual.codigo+", DESCRIPCION:"+e.itemactual.descripcion+". QUE PERTENECE AL PROYECTO CON # DE CONVENIO: "+e.convenioproyecto+" Y NOMBRE: "+e.nombreproyecto);var t="Cordial Saludo,<br><br> Se eliminó el Objetivo : '"+e.itemactual.descripcion+"' del Proyecto con # de Convenio "+e.convenioproyecto+", Nombre: "+e.nombreproyecto+"<br><br>Agradeciendo su atención,<br><br> <b>SINCHI</b><br><br> <i>Este es un servicio de notificaciones generado automáticamente por medio de correo electrónico, no lo responda.</i> <br>",i="Se eliminó el Objetivo : '"+e.itemactual.descripcion+"' del Proyecto con # de Convenio "+e.convenioproyecto+", Nombre: "+e.nombreproyecto;e.envioNotificaciones(i,"Eliminación de Objetivos del Proyecto",t)}else e.showMessage(!0,3e3,"error",o.response.data.message);e.del_item="",e.loading=!1})).catch((function(o){e.showMessage(!0,3e3,"error",o),e.loading=!1}))},OnOffProyObjetivo:function(){var e=this.$store.getters.getProyObjetivo;0==e?this.$store.commit("setProyObjetivo",1):this.$store.commit("setProyObjetivo",0)},saveitem:function(){var e=this.objetivos.length,o=[];this.loading=!0;for(var t=0,i=0;i<e;i++)if(""!=this.objetivos[i].descripcion){var a=this.objetivos[i].descripcion;if(o.length>0){for(var s=0;s<o.length;s++)if(a==o[s].descripcion){var n=i+1;return this.showMessage(!0,3e3,"error","El Objetivo "+a+" del item "+n+" ya se encuentra en el item "+o[s].codigo),void(this.loading=!1)}o.push({codigo:i+1,descripcion:a,proyecto:this.proyecto,peso:this.objetivos[i].peso})}else o.push({codigo:i+1,descripcion:a,proyecto:this.proyecto,peso:this.objetivos[i].peso});t+=parseFloat(this.objetivos[i].peso)}if(parseFloat(t)>100)return this.showMessage(!0,3e3,"error","La suma de los pesos de los objetivos no debe superar el 100%"),void(this.loading=!1);var c=this;r["a"].addupdData(o).then((function(e){if(e.response){var o=e.response.data.message;c.showMessage(!0,3e3,"error",o)}else if(e.statusText){c.showMessage(!0,3e3,"success","Se Actualizarón/Agregarón los Objetivos al Proyecto con éxito"),c.traerObjetivos(c.proyecto),c.agregaBitacora("ACTUALIZACION/CREACION","SE ACTUALIZARON/AGREGARON OBJETIVOS AL PROYECTO CON # DE CONVENIO: "+c.convenioproyecto+" Y NOMBRE: "+c.nombreproyecto),c.OnOffProyObjetivo();var t="Cordial Saludo,<br><br> Se Actualizaron/Crearon Objetivos para el Proyecto con # de Convenio "+c.convenioproyecto+", Nombre: "+c.nombreproyecto+"<br><br>Agradeciendo su atención,<br><br> <b>SINCHI</b><br><br> <i>Este es un servicio de notificaciones generado automáticamente por medio de correo electrónico, no lo responda.</i> <br>",i="Se Actualizaron/Crearon Objetivos para el Proyecto con # de Convenio "+c.convenioproyecto+", Nombre: "+c.nombreproyecto;c.envioNotificaciones(i,"Actualización/Creación de Objetivos del Proyecto",t)}else c.showMessage(!0,3e3,"error",e.message);c.loading=!1})).catch((function(e){c.showMessage(!0,3e3,"error",e),c.loading=!1}))},agregaBitacora:function(e,o){var t={modulo:"OBJETIVOS PROYECTOS",accion:e,detalle:o};this.$root.$emit("agregaBitacora",t)}},watch:{proyecto:function(e){0!=e&&this.traerObjetivos(e)}},mounted:function(){this.traerObjetivos(this.proyecto)}},n=s,c=t("2877"),l=Object(c["a"])(n,i,a,!1,null,null,null);o["default"]=l.exports}}]);
//# sourceMappingURL=chunk-2d0af0a7.6a3c0675.js.map