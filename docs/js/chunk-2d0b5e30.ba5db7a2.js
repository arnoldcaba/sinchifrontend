(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b5e30"],{"1b8a":function(a,e,t){"use strict";t.r(e);var i=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("v-container",{attrs:{fluid:""}},[t("v-card",{attrs:{color:"transparent"}},[t("v-card-title",[a._v("\n            Archivos de control de versiones            \n        ")]),t("v-card-text",[t("div",{staticStyle:{"padding-bottom":"10px"}},[t("v-btn",{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(e){return a.abrirDialogoAbrirArchivo(0)}}},[t("v-icon",{attrs:{dark:""}},[a._v("add")])],1)],1),t("v-data-table",{attrs:{headers:a.headarchivos,items:a.dataarchivos,"disable-sort":!0,"disable-pagination":!0,"hide-default-footer":!0},scopedSlots:a._u([{key:"item.archivo.file_name",fn:function(e){var i=e.item;return[""!=i.archivo.file_path?t("a",{attrs:{target:"_blank",href:i.archivo.file_path}},[a._v("\n                        "+a._s(i.archivo.file_name)+"\n                    ")]):t("span",[a._v(a._s(i.archivo.file_name))])]}},{key:"item.action",fn:function(e){var i=e.item;return[t("v-icon",{staticClass:"mr-5",attrs:{small:"",color:"primary"},on:{click:function(e){return a.abrirDialogoElimFile(i)}}},[a._v("\n                        delete\n                    ")])]}}])})],1)],1),t("v-dialog",{attrs:{width:"800"},model:{value:a.dialog_archivos,callback:function(e){a.dialog_archivos=e},expression:"dialog_archivos"}},[t("v-card",[t("v-card-title",[t("span",{staticClass:"headline red--text"},[a._v(a._s(a.formTitleArchivos))])]),t("v-card-text",[t("v-form",{ref:"validvbpreadd",model:{value:a.validarcadd,callback:function(e){a.validarcadd=e},expression:"validarcadd"}},[t("v-flex",[t("span",[a._v("Archivo")]),t("adjuntarArchivos",{attrs:{item:a.archivoactual,placeholder:"Cargar Archivo",tipoarchivo:".pdf"}})],1),t("br"),t("v-flex",[t("v-text-field",{attrs:{label:"Fecha cargue",type:"date",rules:[a.rules.required]},model:{value:a.fechaarchivo,callback:function(e){a.fechaarchivo=e},expression:"fechaarchivo"}})],1),t("br"),t("v-flex",[t("v-textarea",{attrs:{filled:"",name:"input-7-4",label:"Observación"},model:{value:a.observacionarchivo,callback:function(e){a.observacionarchivo=e},expression:"observacionarchivo"}})],1)],1)],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"primary",dark:"",text:""},on:{click:function(e){a.dialog_archivos=!1,a.editArchivos=-1}}},[a._v("Cancelar")]),t("v-btn",{attrs:{color:"primary",text:"",disabled:!a.validarcadd},on:{click:a.adicionarArchivo}},[a._v("Agregar")])],1)],1)],1),t("v-dialog",{attrs:{width:"550"},model:{value:a.dialog_deletefile,callback:function(e){a.dialog_deletefile=e},expression:"dialog_deletefile"}},[t("v-card",[t("v-card-title",[t("span",{staticClass:"headline red--text"},[a._v("Eliminar Archivo")])]),t("v-card-text",[a._v("\n                ¿Esta seguro de eliminar el Archivo "+a._s(a.filedelete)+" definitivamente?.\t\t\t\t\t\n            ")]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"primary",dark:"",text:""},on:{click:function(e){a.dialog_deletefile=!1}}},[a._v("Cancelar")]),t("v-btn",{attrs:{color:"red",text:""},on:{click:a.eliminarItemArchivos}},[a._v("Eliminar")])],1)],1)],1)],1)},r=[],o=t("a34a"),c=t.n(o),s=t("3bb9");function n(a,e,t,i,r,o,c){try{var s=a[o](c),n=s.value}catch(l){return void t(l)}s.done?e(n):Promise.resolve(n).then(i,r)}function l(a){return function(){var e=this,t=arguments;return new Promise((function(i,r){var o=a.apply(e,t);function c(a){n(o,i,r,c,s,"next",a)}function s(a){n(o,i,r,c,s,"throw",a)}c(void 0)}))}}var h={name:"ArchivosVersiones",props:["proyecto"],components:{adjuntarArchivos:function(){return t.e("chunk-2d2245ed").then(t.bind(null,"e09e"))}},data:function(){return{validarcadd:!1,dataarchivos:[],dialog_archivos:!1,dialog_deletefile:!1,editArchivos:-1,itemactualArchivo:"",tipoarchivo:"",formTitleArchivos:"",codigoarchivo:0,observacionarchivo:"",fechaarchivo:"",archivoactual:{file_name:"",file_path:"",file_name_tmp:""},validvbpreadd:!1,filedelete:"",headarchivos:[{text:"No.",align:"left",sortable:!1,value:"codigo",class:"subtitle-1 font-weight-bold black--text"},{text:"Archivo",align:"left",sortable:!1,value:"archivo.file_name",class:"subtitle-1 font-weight-bold black--text"},{text:"Fecha",align:"left",sortable:!1,value:"fecha",class:"subtitle-1 font-weight-bold black--text"},{text:"Descripción",align:"left",sortable:!1,value:"descripcion",class:"subtitle-1 font-weight-bold black--text"},{text:"Acción",value:"action",sortable:!1,class:"subtitle-1 font-weight-bold black--text"}],rules:{required:function(a){return!!a||"Campo requerido."}}}},methods:{showMessage:function(a,e,t,i){this.$root.$emit("showSnack",{snack:a,time:e,color:t,text:i})},abrirDialogoElimFile:function(a){this.itemactualArchivo=a,this.dialog_deletefile=!0},abrirDialogoAbrirArchivo:function(a){this.itemactualArchivo="",this.editArchivos=a,this.codigoarchivo=0,this.rutaarchivo="",this.archivoactual={file_name:"",file_path:"",file_name_tmp:""},this.dialog_archivos=!0},resetArchivos:function(){this.codigoarchivo=0,this.rutaarchivo="",this.archivoactual={file_name:"",file_path:"",file_name_tmp:""}},eliminarItemArchivos:function(){var a=l(c.a.mark((function a(){var e,t,i;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,s["a"].eliminarArchivo(this.proyecto,this.itemactualArchivo.codigo,this.itemactualArchivo.archivo);case 3:if(e=a.sent,!e.response){a.next=7;break}return this.showMessage(!0,4e3,"error",e.response.data.message),a.abrupt("return");case 7:a.next=13;break;case 9:return a.prev=9,a.t0=a["catch"](0),this.showMessage(!0,4e3,"error",a.t0),a.abrupt("return");case 13:t=0;case 14:if(!(t<this.dataarchivos.length)){a.next=23;break}if(i=this.dataarchivos[t],i.codigo!=this.itemactualArchivo.codigo){a.next=20;break}return this.dataarchivos.splice(t,1),this.showMessage(!0,4e3,"success","Se eliminó el archivo con éxito"),a.abrupt("break",23);case 20:t++,a.next=14;break;case 23:this.traerDatosArchivos(),this.dialog_deletefile=!1;case 25:case"end":return a.stop()}}),a,this,[[0,9]])})));function e(){return a.apply(this,arguments)}return e}(),adicionarArchivo:function(){var a=l(c.a.mark((function a(){var e,t,i;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e=new Date,e.getFullYear().toString().padStart(2,"00")+"-"+(e.getMonth()+1).toString().padStart(2,"00")+"-"+e.getDate().toString(),""!=this.archivoactual.file_name){a.next=5;break}return this.showMessage(!0,3e3,"error","Debe seleccionar el archivo"),a.abrupt("return");case 5:if(0!=this.editArchivos){a.next=25;break}if(t=0,t=this.dataarchivos.reduce((function(a,e){return Math.max(a,e.codigo)}),0),t+=1,0==parseFloat(this.proyecto)){a.next=23;break}return a.prev=10,a.next=13,s["a"].adicionarArchivo(this.proyecto,t,this.archivoactual,this.observacionarchivo,this.fechaarchivo);case 13:if(i=a.sent,!i.response){a.next=17;break}return this.showMessage(!0,4e3,"error",i.response.data.message),a.abrupt("return");case 17:a.next=23;break;case 19:return a.prev=19,a.t0=a["catch"](10),this.showMessage(!0,4e3,"error",a.t0),a.abrupt("return");case 23:this.traerDatosArchivos(),this.showMessage(!0,4e3,"success","Se agregó el archivo con éxito");case 25:this.observacionarchivo="",this.fechaarchivo="",this.editArchivos=-1,this.dialog_archivos=!1;case 29:case"end":return a.stop()}}),a,this,[[10,19]])})));function e(){return a.apply(this,arguments)}return e}(),traerDatosArchivos:function(){var a=this;this.dataarchivos=[],s["a"].getDataArchivos(this.proyecto).then((function(e){if(e.request&&e.data){var t=e.data.data;if(t.length>0)for(var i=0;i<t.length;i++){var r=t[i],o=r.archivo,c=r.rutaarchivo,s={file_name:o,file_path:""!=c?c:"",file_name_tmp:""};a.dataarchivos.push({codigo:r.codigo,archivo:s,fecha:r.fecha,descripcion:r.observacion})}}})).catch((function(a){}))},agregaBitacora:function(a,e){var t={modulo:"ARCHIVOS VERSIONES",accion:a,detalle:e};this.$root.$emit("agregaBitacora",t)}},watch:{proyecto:function(a){0!=a&&this.traerDatosArchivos()}},mounted:function(){this.traerDatosArchivos()},computed:{}},v=h,d=t("2877"),u=Object(d["a"])(v,i,r,!1,null,null,null);e["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d0b5e30.ba5db7a2.js.map