(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0da371"],{"6b3b":function(e,a,i){"use strict";i.r(a);var t=function(){var e=this,a=e.$createElement,i=e._self._c||a;return i("v-container",{attrs:{fluid:""}},[i("v-flex",[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.readonly,expression:"!readonly"}],staticStyle:{"padding-bottom":"10px"}},[i("v-btn",{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(a){e.dialog=!0,e.edit=0,e.itemactual=""}}},[i("v-icon",{attrs:{dark:""}},[e._v("add")])],1)],1),i("v-card",{attrs:{flat:"",tile:""}},[i("v-card-title",{staticClass:"justify-center"},[e._v("OTROSÍ")]),i("v-card-text",[i("v-data-table",{attrs:{headers:e.headers,items:e.data,"items-per-page":5},scopedSlots:e._u([{key:"item.action",fn:function(a){var t=a.item;return[i("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.readonly,expression:"!readonly"}],staticClass:"mr-5",attrs:{small:"",color:"primary",disabled:e.loading},on:{click:function(a){e.dialog=!0,e.edit=1,e.itemactual=t}}},[e._v("\n\t\t\t\t\t\t\t\tedit\n\t\t\t\t\t\t\t")]),i("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.readonly,expression:"!readonly"}],staticClass:"mr-5",attrs:{small:"",color:"primary",disabled:e.loading,loading:e.loading},on:{click:function(a){e.dialog_del=!0,e.itemactual=t}}},[e._v("\n                                delete\n                            ")])]}}])})],1)],1)],1),i("v-dialog",{attrs:{"max-width":"1000px"},model:{value:e.dialog,callback:function(a){e.dialog=a},expression:"dialog"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),i("v-card-text",[i("v-container",{attrs:{"grid-list-md":""}},[i("v-layout",{attrs:{wrap:"",column:""}},[i("v-form",{ref:"form",model:{value:e.valid,callback:function(a){e.valid=a},expression:"valid"}},[i("v-row",[i("v-col",[i("v-flex",[i("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(a){var t=a.on;return[i("v-text-field",e._g({attrs:{label:"Fecha suscripción","prepend-icon":"event",readonly:""},model:{value:e.fechasuscripcion,callback:function(a){e.fechasuscripcion=a},expression:"fechasuscripcion"}},t))]}}]),model:{value:e.menuDate,callback:function(a){e.menuDate=a},expression:"menuDate"}},[i("v-date-picker",{attrs:{type:"date"},on:{input:function(a){e.menuDate=!1}},model:{value:e.fechasuscripcion,callback:function(a){e.fechasuscripcion=a},expression:"fechasuscripcion"}})],1)],1)],1),i("v-col",[i("v-flex",[i("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(a){var t=a.on;return[i("v-text-field",e._g({attrs:{label:"Fecha inicio","prepend-icon":"event",readonly:""},model:{value:e.fechainicio,callback:function(a){e.fechainicio=a},expression:"fechainicio"}},t))]}}]),model:{value:e.menuDate2,callback:function(a){e.menuDate2=a},expression:"menuDate2"}},[i("v-date-picker",{attrs:{type:"date"},on:{input:function(a){e.menuDate2=!1}},model:{value:e.fechainicio,callback:function(a){e.fechainicio=a},expression:"fechainicio"}})],1)],1)],1),i("v-col",[i("v-flex",[i("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(a){var t=a.on;return[i("v-text-field",e._g({attrs:{label:"Fecha terminación","prepend-icon":"event",readonly:""},model:{value:e.fechaterminacion,callback:function(a){e.fechaterminacion=a},expression:"fechaterminacion"}},t))]}}]),model:{value:e.menuDate1,callback:function(a){e.menuDate1=a},expression:"menuDate1"}},[i("v-date-picker",{attrs:{type:"date"},on:{input:function(a){e.menuDate1=!1}},model:{value:e.fechaterminacion,callback:function(a){e.fechaterminacion=a},expression:"fechaterminacion"}})],1)],1)],1)],1)],1)],1)],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",text:""},on:{click:e.cerrarDialogo}},[e._v("Cancelar")]),i("v-btn",{attrs:{color:"primary",text:"",disabled:!e.valid},on:{click:e.saveitem}},[e._v("Guardar")])],1)],1)],1),i("v-dialog",{attrs:{width:"550"},model:{value:e.dialog_del,callback:function(a){e.dialog_del=a},expression:"dialog_del"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline red--text"},[e._v("Eliminar Otro Si")])]),i("v-card-text",[e._v("\t\t\t\t\t\n                    ¿Esta seguro de eliminar el otrosí seleccionado?.\t\t\t\t\t\n                ")]),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",dark:"",text:""},on:{click:function(a){e.dialog_del=!1}}},[e._v("Cancelar")]),i("v-btn",{attrs:{color:"red",text:""},on:{click:e.deleteItem}},[e._v("Eliminar")])],1)],1)],1)],1)},n=[],o=i("bc3a"),c=i.n(o),r=i("d89f"),s={getData:function(){return new Promise((function(e,a){c()({method:"POST",url:r["a"].apiUrl+"/ConveniosMarcoOtrosi",dataType:"json"}).then((function(a){e(a)})).catch((function(a){e(a)}))}))},getDataXConvenio:function(e){return new Promise((function(a,i){c()({method:"POST",url:r["a"].apiUrl+"/OtroSiXConvenioMarco",dataType:"json",data:{convenio:e}}).then((function(e){a(e)})).catch((function(e){a(e)}))}))},guardarData:function(e){return new Promise((function(a,i){c()({method:"POST",url:r["a"].apiUrl+"/addupdConvenioMarcoOtrosi",dataType:"json",data:{data:e}}).then((function(e){a(e)})).catch((function(e){a(e)}))}))},DelData:function(e,a){return new Promise((function(i,t){c()({method:"POST",url:r["a"].apiUrl+"/delConvenioMarcoOtrosi",dataType:"json",data:{codigo:e,convenio:a}}).then((function(e){i(e)})).catch((function(e){i(e)}))}))}},l=s,d=i("4d90"),h={name:"OtroSiCM",props:["convenio"],data:function(){return{loading:!1,dialog:!1,edit:-1,dialog_del:!1,processing:!1,formTitle:"",itemactual:"",valid:!1,fechasuscripcion:"",fechainicio:"",fechaterminacion:"",conveniomarco:"",nombreconvenio:"",menuDate:!1,menuDate1:!1,menuDate2:!1,data:[],readonly:!1,headers:[{text:"Fecha inicio",value:"fechainicio",sortable:!1,align:"left",class:"subtitle-1 font-weight-bold black--text"},{text:"Fecha suscripción",align:"left",sortable:!1,value:"fechasuscripcion",class:"subtitle-1 font-weight-bold black--text"},{text:"Fecha terminación",value:"fechaterminacion",sortable:!1,align:"left",class:"subtitle-1 font-weight-bold black--text"},{text:"Acción",value:"action",sortable:!1,align:"left",class:"subtitle-1 font-weight-bold black--text"}],rules:{required:function(e){return!!e||"Campo requerido."},valor:function(e){return e>0||"El Valor debe ser mayor a 0."},minDate:function(e){return e<(new Date).toISOString()||"La fecha no puede ser superior al dia de hoy"},maxDate:function(e){return e>=(new Date).toISOString()||"La fecha no puede ser inferior al dia de hoy"}}}},methods:{showMessage:function(e,a,i,t){this.$root.$emit("showSnack",{snack:e,time:a,color:i,text:t})},envioNotificaciones:function(e,a,i){this.$emit("envioNotificaciones",{mensajenotificacion:e,asuntocorreo:a,mensajecorreo:i})},resetForm:function(){this.codigo="0",this.fechasuscripcion="",this.fechaterminacion="",this.fechainicio=""},cerrarDialogo:function(){this.resetForm(),this.dialog=!1,this.edit=-1},traerDataConvenio:function(){var e=this;e.conveniomarco="",e.nombreconvenio="",d["a"].getDataXId(this.convenio).then((function(a){a.request&&a.data&&(e.conveniomarco=a.data.data[0].codigo,e.nombreconvenio=a.data.data[0].nombreasociado),e.loading=!1})).catch((function(e){}))},traerdata:function(e){var a=this;this.loading=!0,l.getDataXConvenio(e).then((function(e){e.request&&e.data?a.data=e.data.data:a.data=[],a.loading=!1})).catch((function(e){a.data=[],a.loading=!1}))},deleteItem:function(){var e=this;this.loading=!0,l.DelData(e.itemactual.codigo,e.convenio).then((function(a){a.statusText?(e.showMessage(!0,3e3,"success","Se eliminó el Otro Si con éxito"),e.del_item="",e.traerdata(e.convenio),e.dialog_del=!1,e.agregaBitacora("ELIMINACION","SE ELIMINÓ EL OTRO SI CON FECHA DE SUSCRIPCIÓN:"+e.itemactual.fechasuscripcion+", FECHA DE INCORPORACION:"+e.itemactual.fechainicio+", FECHA TERMINACION: "+e.itemactual.fechaterminacion+". QUE PERTENECE AL CONVENIO MARCO: "+e.conveniomarco+" Y NOMBRE ASOCIADO: "+e.nombreconvenio)):e.showMessage(!0,3e3,"error",a.response.data.message),e.del_item="",e.loading=!1})).catch((function(a){e.showMessage(!0,3e3,"error",a),e.loading=!1}))},validaSave:function(){return this.itemactual.fechasuscripcion!=this.fechasuscripcion||this.itemactual.fechaterminacion!=this.fechaterminacion||this.itemactual.fechainicio!=this.fechainicio},saveitem:function(){this.loading=!0;var e=this,a="",i={codigo:this.codigo,convenio:this.convenio,fechasuscripcion:this.fechasuscripcion,fechaterminacion:this.fechaterminacion,fechainicio:this.fechainicio},t=this.validaFechas();if(""!=t)return this.showMessage(!0,5e3,"error",t),void(this.loading=!1);if(this.edit){var n=this.validaSave();if(!n)return this.showMessage(!0,3e3,"error","No hay datos para actualizar"),void(this.loading=!1);a="",this.itemactual.fechasuscripcion!=this.fechasuscripcion&&(a+="Fecha Suscripción: "+this.itemactual.fechasuscripcion+" a "+this.fechasuscripcion),this.itemactual.fechainicio!=this.fechainicio&&(a+=""==a?"Fecha de Inicio: "+this.itemactual.fechainicio+" a "+this.fechainicio:", Fecha de Inicio: "+this.itemactual.fechainicio+" a "+this.fechainicio),this.itemactual.fechaterminacion!=this.fechaterminacion&&(a+=""==a?"Fecha Terminación: "+this.itemactual.fechaterminacion+" a "+this.fechaterminacion:", Fecha Terminación: "+this.itemactual.fechaterminacion+" a "+this.fechaterminacion),a="CODIGO: "+this.codigo+" ("+a+")"}else a+="Fecha Suscripción : "+this.fechasuscripcion+", Fecha de Inicio: "+this.fechainicio+", Fecha Terminación: "+this.fechaterminacion;l.guardarData(i).then((function(i){if(i.response){var t=i.response.data.message;e.showMessage(!0,3e3,"error",t)}else if(i.statusText){var n="",o="";e.edit?(n="Actualizó",o="ACTUALIZACION"):(n="Agregó",o="CREACION"),e.showMessage(!0,3e3,"success","Se "+n+" el Otro Si con éxito"),e.agregaBitacora(o,a),e.traerdata(e.convenio),e.dialog=!1}else e.showMessage(!0,3e3,"error",i.message);e.loading=!1})).catch((function(a){e.showMessage(!0,3e3,"error",a),e.loading=!1}))},number_format:function(e,a){if(e+="",e=parseFloat(e.replace(/[^0-9\.]/g,"")),a=a||0,isNaN(e)||0===e)return parseFloat(0).toFixed(a);e=""+e.toFixed(a);var i=e.split("."),t=/(\d+)(\d{3})/;while(t.test(i[0]))i[0]=i[0].replace(t,"$1.$2");return i.join(",")},formatearValor:function(e,a){var i=e;switch(i=this.limpiarMoneda(i),i=this.number_format(i,2),a){case"cofinanciado":this.cofinanciado=i;break;case"contrapartida":this.contrapartida=i;break;case"totaldinero":this.totaldinero=i;break;case"totalespecie":this.totalespecie=i;break;default:break}},limpiarMoneda:function(e){var a=e.toString().replace(/[$.]/gi,"");return a=a.replace(/[,]/gi,"."),a.trim()},validaFechas:function(){if(""==this.fechasuscripcion||""==this.fechainicio||""==this.fechaterminacion)return"";var e=new Date(this.fechasuscripcion),a=new Date(this.fechainicio),i=new Date(this.fechaterminacion);return i<=e?"La Fecha de Terminación debe ser superior a la Fecha de Suscripción":i<=a?"La Fecha de Terminación debe ser superior a la Fecha de Inicio":""},agregaBitacora:function(e,a){var i={modulo:"OTRO SI CONVENIO MARCO",accion:e,detalle:a};this.$root.$emit("agregaBitacora",i)}},watch:{edit:function(e){"1"==e||"2"==e?(this.formTitle="1"==e?"Editar":"Detalle (Solo Consulta)",this.codigo=this.itemactual.codigo,this.fechasuscripcion=this.itemactual.fechasuscripcion,this.fechaterminacion=this.itemactual.fechaterminacion,this.fechainicio=this.itemactual.fechainicio):(this.resetForm(),this.formTitle="Nuevo")},convenio:function(e){0!=e&&(this.traerdata(e),this.traerDataConvenio())}},computed:{},mounted:function(){this.traerDataConvenio(),this.traerdata(this.convenio)}},u=h,f=i("2877"),m=Object(f["a"])(u,t,n,!1,null,null,null);a["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2d0da371.961601a2.js.map