(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28543dde"],{5620:function(t,a,i){"use strict";var e=i("d6d7"),o=i.n(e);o.a},a5da:function(t,a,i){"use strict";i.r(a);var e=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("v-container",[i("v-flex",[i("v-card",{attrs:{elevation:"3"}},[i("v-card-title",[t._v("Necesidad")]),i("v-card-text",[i("span",[i("b",[t._v("Descripción:  ")]),t._v(t._s(t.descripcionnecesidad))]),i("br"),i("span",[i("b",[t._v("Valor:  ")]),t._v(t._s(t.moneda+" "+t.number_format(t.valornecesidad,2)))])])],1),i("br"),i("v-card",[i("v-card-title",{staticClass:"justify-center"},[t._v("\n\t\t\t\t\tACTIVIDADES - NECESIDADES\n\t\t\t\t")]),i("v-card-text",[i("v-text-field",{attrs:{"append-icon":"search",label:"Buscar","single-line":"","hide-details":""},model:{value:t.search,callback:function(a){t.search=a},expression:"search"}})],1),i("v-layout",{staticStyle:{"padding-top":"16px"},attrs:{column:""}},[i("v-data-table",{attrs:{headers:t.headers,items:t.data,"items-per-page":5,"disable-sort":!0,search:t.search},scopedSlots:t._u([{key:"item.valor",fn:function(a){var e=a.item;return[i("span",[t._v(t._s(t._f("currency")(e.valor,{symbol:t.moneda,thousandsSeparator:".",fractionCount:"0",fractionSeparator:",",symbolPosition:"front",symbolSpacing:!0}))+"\n\t\t\t\t\t\t\t")])]}},{key:"item.tipomod",fn:function(a){var e=a.item;return[i("span",{class:[{ColorVBTrue:"N"===e.tipomod},{ColorVBFalse:"E"==e.tipomod},{ColorVBModifica:"M"==e.tipomod}]},[t._v("\n\t\t\t\t\t\t\t\t"+t._s("N"==e.tipomod?"NUEVO":"M"==e.tipomod?"MODIFICADO":"E"==e.tipomod?"ELIMINADO":"")+"\n\t\t\t\t\t\t\t")])]}}])})],1)],1)],1)],1)},o=[],r=i("a34a"),s=i.n(r),n=i("c032"),c=i("d761"),d=i("59e1");function l(t,a,i,e,o,r,s){try{var n=t[r](s),c=n.value}catch(d){return void i(d)}n.done?a(c):Promise.resolve(c).then(e,o)}function u(t){return function(){var a=this,i=arguments;return new Promise((function(e,o){var r=t.apply(a,i);function s(t){l(r,e,o,s,n,"next",t)}function n(t){l(r,e,o,s,n,"throw",t)}s(void 0)}))}}function h(t){return h="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}var p={name:"Actividades",props:["planadquisicion","necesidad","descripcionnecesidad","moneda","valortotal","proyecto","convenio","valornecesidad","tasa","enviovobo"],data:function(){return{modulo:"ACTIVIDADES NECESIDADES",loading:!1,dialog:!1,edit:-1,dialog_del:!1,processing:!1,formTitle:"",valid:!1,search:"",secuenciaactividad:0,categoriagasto:0,topecategoriagasto:0,valor:0,tipotope:"",presupuesto:"",fuefinpgn:"",fuefinsgr:"",fuefincofinanciado:"",fuefinfuncionamiento:"",coordinador:"",nommoneda:"",nomsufijo:"",itemactual:"",data:[],dataoriginal:[],arrActividades:[],arrCatGasto:[],headers:[{text:"Actividad",align:"left",sortable:!1,value:"actividadtxt"},{text:"Categoría del Gasto",align:"left",sortable:!1,value:"categoriagastotxt"},{text:"Valor",align:"left",sortable:!1,value:"valor"},{text:"Rubro Presupuestal",align:"left",sortable:!1,value:"rubro"},{text:"Tipo Mod.",value:"tipomod",sortable:!1}],rules:{required:function(t){return!!t||"Campo requerido."}}}},filters:{},methods:{showMessage:function(t,a,i,e){this.$root.$emit("showSnack",{snack:t,time:a,color:i,text:e})},resetForm:function(){this.secuenciaactividad=0,this.categoriagasto=0,this.topecategoriagasto=0,this.valor=0},cerrarDialogo:function(){this.resetForm(),this.dialog=!1,this.edit=-1},traerData:function(){var t=this,a=this.$store.getters.getArrPlanAdqNecAct,i=a.filter((function(a){return a.necesidad==t.necesidad}));this.data=i},traerDataBase:function(){var t=this;this.dataoriginal=[],n["a"].getActividadXNecesidad(this.planadquisicion,this.necesidad).then((function(a){a.request&&a.data&&(t.dataoriginal=a.data)})).catch((function(t){}))},traerActividades:function(){var t=this;this.arrActividades=[],c["a"].FiltroXProyectoAll(this.proyecto).then((function(a){t.arrActividades=a})).catch((function(t){}))},traerCategoriaGasto:function(){var t=this;this.arrCatGasto=[],d["a"].getCatGasXConvenio(this.convenio).then((function(a){a.request&&a.data&&(t.arrCatGasto=a.data.data)})).catch((function(t){}))},traerPresupuestoConvenio:function(){var t=this;this.fuefinpgn="",this.fuefinsgr="",this.fuefincofinanciado="",this.fuefinfuncionamiento="",this.coordinador="",d["a"].getDataXConvenio(this.convenio).then((function(a){a.request&&a.data&&(t.fuefinpgn=a.data.data[0].fuefinanciacionpgn,t.fuefinsgr=a.data.data[0].fuefinanciacionsgr,t.fuefincofinanciado=a.data.data[0].fuefinanciacioncof,t.fuefinfuncionamiento=a.data.data[0].fuefinanciacionfun,t.coordinador=a.data.data[0].coordinador)})).catch((function(t){}))},closeDialogoDel:function(){this.dialog_del=!1},deleteItem:function(t){for(var a=0;a<this.$store.getters.getArrPlanAdqNecAct.length;a++){var i=this.$store.getters.getArrPlanAdqNecAct[a];if(i.secuenciaactividad==t.secuenciaactividad&&i.necesidad==this.necesidad){if("N"==i.tipomod)this.$store.commit("DelArrPlanAdqNecAct",a);else if("E"!=i.tipomod)t.tipomod="E",this.$store.commit("ModArrPlanAdqNecAct",t);else if("E"==i.tipomod){t.tipomod="";for(var e=0;e<this.dataoriginal.length;e++){var o=this.dataoriginal[e];o.secuenciaactividad==t.secuenciaactividad&&(o.categoriagasto==t.categoriagasto&&o.topecategoriagasto==t.topecategoriagasto&&o.rubro==t.rubro&&parseFloat(o.valor)==parseFloat(t.valor)||(t.tipomod="M"))}this.$store.commit("ModArrPlanAdqNecAct",t)}break}}this.traerData()},validaGuardar:function(t){try{var a=0,i=0;if("object"==h(this.secuenciaactividad)?(a=this.secuenciaactividad.secuencia,this.secuenciaactividad.descripcionfull):(a=this.secuenciaactividad,this.itemactual.actividadtxt),"object"==h(this.categoriagasto)?(i=this.categoriagasto.codigo,this.categoriagasto.nombre):(i=this.categoriagasto,this.itemactual.categoriagastotxt),this.edit){if(a==this.itemactual.secuenciaactividad&&i==this.itemactual.categoriagasto&&parseFloat(this.limpiarMoneda(this.valor))==parseFloat(this.itemactual.valor))return"No hay datos para actualizar"}else for(var e=0;e<this.data.length;e++){var o=this.data[e],r=e+1;if(a==o.secuenciaactividad)return"La Actividad ya ha salido seleccionada en el item No. '"+r+"'"}if(""==this.valor||"0"==this.valor||void 0==this.valor)return"Debe ingresar el Valor de la Actividad";var s=parseFloat(this.limpiarMoneda(this.topecategoriagasto)),n=parseFloat(this.limpiarMoneda(this.valor));if(s>0)if("M"==this.tipotope){if(n>s)return"El Valor de la Actividad no puede superar el valor del Tope"}else if("P"==this.tipotope){var c=parseFloat(this.valortotal)*parseFloat(s)/100;if(n>parseFloat(c))return"El Valor de la Actividad no puede superar el valor del Tope"}var d=parseFloat(this.limpiarMoneda(this.valor)),l=parseFloat(this.limpiarMoneda(this.valortotal)),u=0;0==this.edit&&(u+=d);for(var p=0;p<this.data.length;p++){var f=this.data[p];a==f.secuenciaactividad?u+=d:u+=parseFloat(this.limpiarMoneda(f.valor))}if(u>parseFloat(this.valornecesidad))return"El Valor total de las Actividades supera el valor de la Necesidad";if(u>l)return"El Valor total de las Actividades supera el valor Total del Acuerdo Específico";var g=0,v=parseFloat(this.limpiarMoneda(this.topecategoriagasto));0==this.edit&&(g+=d);for(var m=0;m<t.data.length;m++){var A=t.data[m];a==A.secuenciaactividad?g+=d:g+=parseFloat(this.limpiarMoneda(A.valor))}return g>v?"El Valor total de las Actividades para la Categoría del Gasto seleccionada supera el tope de la misma":""}catch(b){return b}},saveitem:function(){var t=u(s.a.mark((function t(){var a,i,e,o,r,c,d,l,u,p,f,g,v,m;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=0,i="",e="",o=0,r="","object"==h(this.secuenciaactividad)?(a=this.secuenciaactividad.secuencia,e=this.secuenciaactividad.descripcionfull,i=this.secuenciaactividad.codigofull):(a=this.secuenciaactividad,e=this.itemactual.actividadtxt,i=this.itemactual.codigofull),"object"==h(this.categoriagasto)?(o=this.categoriagasto.codigo,r=this.categoriagasto.nombre):(o=this.categoriagasto,r=this.itemactual.categoriagastotxt),t.next=9,n["a"].getActividadXPlanCategoria(this.planadquisicion,o);case 9:if(c=t.sent,d=this.validaGuardar(c),"",""==d){t.next=15;break}return this.showMessage(!0,3e3,"error",d),t.abrupt("return");case 15:l="",u="","1"==this.fuefinpgn||1==this.fuefinpgn?u="91":"1"==this.fuefinsgr||1==this.fuefinsgr?u="50":"1"==this.fuefincofinanciado||1==this.fuefincofinanciado?u="80":"1"!=this.fuefinfuncionamiento&&1!=this.fuefinfuncionamiento||(u="30"),p="000"+this.proyecto.toString(),f="00"+o.toString(),g="00"+this.coordinador.toString(),p=p.substring(p.length-3,p.length),f=f.substring(f.length-2,f.length),g=g.substring(g.length-2,g.length),l=u.toString()+p.toString()+i.toString()+g.toString()+f.toString(),this,v=0,v=this.limpiarMoneda(this.topecategoriagasto),"$"==this.moneda.trim()&&parseFloat(this.tasa)>0&&(v=parseFloat(v)/parseFloat(this.tasa)),m={planadquisicion:this.planadquisicion,necesidad:this.necesidad,actividadtxt:e,categoriagastotxt:r,codigofull:i,secuenciaactividad:a,categoriagasto:o,topecategoriagasto:v,presupuesto:this.presupuesto,valor:this.limpiarMoneda(this.valor),rubro:l,tipomod:1==this.edit?"M":"N"},this.edit?this.$store.commit("ModArrPlanAdqNecAct",m):this.$store.commit("AddArrPlanAdqNecAct",m),this.traerData(),this.dialog=!1;case 33:case"end":return t.stop()}}),t,this)})));function a(){return t.apply(this,arguments)}return a}(),agregaTope:function(t){this.tipotope=t.tipotope,"M"==this.tipotope&&("$"==this.moneda.trim()&&parseFloat(this.tasa)>0?this.topecategoriagasto=this.formatearValor(t.topemaximo*this.tasa,0):this.topecategoriagasto=this.formatearValor(t.topemaximo,0)),this.nommoneda="",this.nomsufijo="","M"==this.tipotope?this.nommoneda=this.moneda:"P"==this.tipotope&&(this.nomsufijo="%")},number_format:function(t,a){if(t+="",t=parseFloat(t.replace(/[^0-9\.]/g,"")),a=a||0,isNaN(t)||0===t)return parseFloat(0).toFixed(a);t=""+t.toFixed(a);var i=t.split("."),e=/(\d+)(\d{3})/;while(e.test(i[0]))i[0]=i[0].replace(e,"$1.$2");return i.join(",")},limpiarMoneda:function(t){var a=t.toString().replace(",00","").replace(/[$.]/gi,"");return a=a.replace(/[,]/gi,"."),a},formatearValor:function(t){var a=t;return a=this.limpiarMoneda(a),a=this.number_format(a,2),a},formatearValorActividad:function(t){this.valor=this.formatearValor(t)},agregaBitacora:function(t,a){var i={modulo:this.modulo,accion:t,detalle:a};this.$root.$emit("agregaBitacora",i)}},watch:{arrCatGasto:function(t){this.presupuesto=0,t.length>0&&(this.presupuesto=t[0].presupuesto)},edit:function(t){if(t){this.formTitle="Editar",this.secuenciaactividad=this.itemactual.secuenciaactividad,this.categoriagasto=this.itemactual.categoriagasto,this.presupuesto=this.itemactual.presupuesto,this.valor=void 0!=this.itemactual.valor?this.formatearValor(this.itemactual.valor):0;for(var a=0;a<this.arrCatGasto.length;a++){var i=this.arrCatGasto[a];if(i.codigo==this.itemactual.categoriagasto){this.tipotope=i.tipotope,this.topecategoriagasto=void 0!=i.topemaximo?i.topemaximo:0,"M"==this.tipotope&&("$"==this.moneda.trim()&&parseFloat(this.tasa)>0?this.topecategoriagasto=this.formatearValor(this.topecategoriagasto*this.tasa):this.topecategoriagasto=this.formatearValor(this.topecategoriagasto));break}}this.nommoneda="",this.nomsufijo="","M"==this.tipotope?this.nommoneda=this.moneda:"P"==this.tipotope&&(this.nomsufijo="%")}else this.resetForm(),this.formTitle="Nuevo"},planadquisicion:function(t){0!=t&&(this.traerData(),this.traerActividades(),this.traerCategoriaGasto(),this.traerPresupuestoConvenio(),this.traerDataBase())},necesidad:function(t){0!=t&&(this.traerData(),this.traerActividades(),this.traerCategoriaGasto(),this.traerPresupuestoConvenio(),this.traerDataBase())}},mounted:function(){this.traerData(),this.traerActividades(),this.traerCategoriaGasto(),this.traerPresupuestoConvenio(),this.traerDataBase()}},f=p,g=(i("5620"),i("2877")),v=Object(g["a"])(f,e,o,!1,null,null,null);a["default"]=v.exports},d6d7:function(t,a,i){}}]);
//# sourceMappingURL=chunk-28543dde.7bec5b20.js.map