(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22d799"],{f83d:function(o,e,t){"use strict";t.r(e);var i=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("v-container",[t("v-card",{attrs:{flat:"",tile:""}},[o.length>0?t("v-window",{attrs:{reverse:""},model:{value:o.onboarding,callback:function(e){o.onboarding=e},expression:"onboarding"}},o._l(o.arrObjetivos,(function(e){return t("v-window-item",{key:"card-"+e.codigo},[t("v-card",{attrs:{color:"transparent",height:"400"}},[t("v-row",{attrs:{tag:"v-card-text"}},[t("h2",{attrs:{color:"black"}},[o._v(o._s(e.codigo+". Objetivo: "+e.descripcion))])]),t("v-row",[t("v-card-text",[t("v-data-table",{attrs:{headers:o.headers,items:o.data,"items-per-page":3},scopedSlots:o._u([{key:"item.descripcion",fn:function(e){var i=e.item;return[t("v-text-field",{attrs:{readonly:o.readonly},model:{value:i.descripcion,callback:function(e){o.$set(i,"descripcion",e)},expression:"item.descripcion"}})]}},{key:"item.peso",fn:function(e){var i=e.item;return[t("v-text-field",{attrs:{type:"number",readonly:o.readonly,min:"0",rules:[o.rules.maxPorcentaje],suffix:" %"},model:{value:i.peso,callback:function(e){o.$set(i,"peso",e)},expression:"item.peso"}})]}},{key:"item.action",fn:function(e){var i=e.item;return[t("v-icon",{directives:[{name:"show",rawName:"v-show",value:!o.readonly&&0!=i.codigoreal,expression:"!readonly && item.codigoreal != 0"}],staticClass:"mr-5",attrs:{small:"",color:"primary",disabled:o.loading,loading:o.loading},on:{click:function(e){o.dialog_del=!0,o.itemactual=i}}},[o._v("\n                                    delete\n                                ")])]}}],null,!0)})],1)],1)],1)],1)})),1):o._e(),t("v-card-actions",{staticClass:"justify-space-between"},[t("v-btn",{attrs:{text:""},on:{click:o.prev}},[t("v-icon",[o._v("chevron_left")])],1),t("v-item-group",{staticClass:"text-center",attrs:{mandatory:""},model:{value:o.onboarding,callback:function(e){o.onboarding=e},expression:"onboarding"}},o._l(o.length,(function(e){return t("v-item",{key:"btn-"+e,scopedSlots:o._u([{key:"default",fn:function(e){var i=e.active,a=e.toggle;return[t("v-btn",{attrs:{"input-value":i,icon:""},on:{click:a}},[t("v-icon",[o._v("fiber_manual_record")])],1)]}}],null,!0)})})),1),t("v-btn",{attrs:{text:""},on:{click:o.next}},[t("v-icon",[o._v("chevron_right")])],1)],1),t("div",{staticStyle:{"text-align":"right"}},[t("v-btn",{directives:[{name:"show",rawName:"v-show",value:!o.readonly,expression:"!readonly"}],attrs:{color:"primary",text:""},on:{click:o.saveitem}},[o._v("Guardar Productos")])],1)],1),t("v-dialog",{attrs:{width:"550"},model:{value:o.dialog_del,callback:function(e){o.dialog_del=e},expression:"dialog_del"}},[t("v-card",[t("v-card-title",[t("span",{staticClass:"headline red--text"},[o._v("Eliminar Producto")])]),t("v-card-text",[o._v("\t\t\t\t\t\n                ¿Esta seguro de eliminar el Producto seleccionado?. Está acción eliminará tambien las actividades asociadas a este producto.\t\t\t\t\t\n            ")]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"primary",dark:"",text:""},on:{click:function(e){o.dialog_del=!1}}},[o._v("Cancelar")]),t("v-btn",{attrs:{color:"red",text:""},on:{click:o.deleteItem}},[o._v("Eliminar")])],1)],1)],1)],1)},a=[],r=t("9d5e"),n=t("c088");function c(o){return c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"===typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},c(o)}var s={name:"Productos",props:["proyecto","readonly","convenioproyecto","nombreproyecto","codigocoordinador"],data:function(){return{loading:!1,length:0,onboarding:0,itemactual:"",dialog_del:!1,inicio:0,data:[{codigo:0,peso:0,descripcion:"",codigoreal:0,objetivo:0}],headers:[{text:"No.",value:"codigo",sortable:!1,align:"left",width:"10%"},{text:"Descripción",value:"descripcion",sortable:!1,align:"left",width:"70%"},{text:"Peso",value:"peso",sortable:!1,align:"left",width:"10%"},{text:"Acción",align:"left",sortable:!1,value:"action",width:"10%"}],arrProgramas:[],arrObjetivos:[],rules:{maxPorcentaje:function(o){return o<100||"El % no puede superar el 100%"}}}},methods:{showMessage:function(o,e,t,i){this.$root.$emit("showSnack",{snack:o,time:e,color:t,text:i})},envioNotificaciones:function(o,e,t){this.$emit("envioNotificaciones",{mensajenotificacion:o,asuntocorreo:e,mensajecorreo:t})},dataVacios:function(){var o=0;for(this.data=[],o;o<30;o++)this.data.push({codigo:o+1,descripcion:"",codigoreal:0,objetivo:0,peso:0})},traerdata:function(o,e){var t=this;this.loading=!0,r["a"].BuscarXObjetivo(o,e).then((function(o){if(o.request){if(o.data){t.data=o.data.data;var e=t.data.length,i=0;i=t.arrObjetivos[t.onboarding].codigo;for(var a=e;a<30;a++)t.data.push({codigo:a+1,descripcion:"",codigoreal:0,objetivo:i,peso:0})}else t.data=[],t.dataVacios();if(t.data.length<=0)for(var r=0;r<30;r++)t.data.push({codigo:r+1,descripcion:"",codigoreal:0,objetivo:i,peso:0})}else t.data=[],t.dataVacios();t.loading=!1})).catch((function(o){t.data=[],t.dataVacios(),t.loading=!1}))},traerObjetivos:function(o){var e=this;n["a"].BuscarXProyecto(o).then((function(o){o.request&&o.data?(e.arrObjetivos=o.data.data,e.length=e.arrObjetivos.length,0==e.inicio&&(e.traerdata(e.proyecto,e.arrObjetivos[e.onboarding].codigo),e.inicio=1)):(e.arrObjetivos=[],e.length=0)})).catch((function(o){e.arrObjetivos=[],e.length=0}))},deleteItem:function(){var o=this;this.loading=!0,r["a"].DelData(o.proyecto,o.itemactual.codigoobjetivo,o.itemactual.codigo).then((function(e){if(e.statusText){o.showMessage(!0,3e3,"success","Se eliminó el Producto con éxito"),o.del_item="",o.traerdata(o.proyecto,o.arrObjetivos[o.onboarding].codigo),o.dialog_del=!1,o.agregaBitacora("ELIMINACION","SE ELIMINÓ EL PRODUCTO CON CODIGO:"+o.itemactual.codigo+", DESCRIPCION:"+o.itemactual.descripcion+". DEL OBJETIVO "+o.itemactual.txtobjetivo+". QUE PERTENECE AL PROYECTO CON # DE CONVENIO: "+o.convenioproyecto+" Y NOMBRE: "+o.nombreproyecto);var t="Cordial Saludo,<br><br> Se eliminó el Producto : '"+o.itemactual.descripcion+"' del objetivo '"+o.itemactual.txtobjetivo+"' que pertenece al Proyecto con # de Convenio "+o.convenioproyecto+", Nombre: "+o.nombreproyecto+"<br><br>Agradeciendo su atención,<br><br> <b>SINCHI</b><br><br> <i>Este es un servicio de notificaciones generado automáticamente por medio de correo electrónico, no lo responda.</i> <br>",i="Se eliminó el Producto : '"+o.itemactual.descripcion+"' del objetivo '"+o.itemactual.txtobjetivo+"' que pertenece al Proyecto con # de Convenio "+o.convenioproyecto+", Nombre: "+o.nombreproyecto;o.envioNotificaciones(i,"Eliminación de Productos del Proyecto",t)}else o.showMessage(!0,3e3,"error",e.response.data.message);o.del_item="",o.loading=!1})).catch((function(e){o.showMessage(!0,3e3,"error",e),o.loading=!1}))},saveitem:function(){var o=this.data.length,e=[];this.loading=!0;for(var t=0,i=0;i<o;i++){var a="";if("object"==c(this.data[i].codigo)?(this.data[i].codigo.codigo,a=this.data[i].codigo.descripcion):(this.data[i].codigo,a=this.data[i].descripcion),""!=a)if(e.length>0){for(var n=0;n<e.length;n++)if(a==e[n].descripcion){var s=i+1;return this.showMessage(!0,3e3,"error","El Producto "+a+" del item "+s+" ya se encuentra en el item "+e[n].no),void(this.loading=!1)}e.push({codigo:i+1,descripcion:a,proyecto:this.proyecto,objetivo:this.arrObjetivos[this.onboarding].codigo,no:i+1,peso:this.data[i].peso})}else e.push({codigo:i+1,descripcion:a,proyecto:this.proyecto,objetivo:this.arrObjetivos[this.onboarding].codigo,no:i+1,peso:this.data[i].peso});t+=parseFloat(this.data[i].peso)}if(parseFloat(t)>100){var d="La suma de los pesos de los productos no debe superar el 100%";return this.showMessage(!0,3e3,"error",d),void(this.loading=!1)}var l=this;r["a"].addupdData(e).then((function(o){if(o.response){var e=o.response.data.message;l.showMessage(!0,3e3,"error",e)}else if(o.statusText){l.showMessage(!0,3e3,"success","Se Actualizarón/Agregarón los Productos con éxito"),l.traerdata(l.proyecto,l.arrObjetivos[l.onboarding].codigo),l.agregaBitacora("ACTUALIZACION/CREACION","SE ACTUALIZARON/AGREGARON PRODUCTOS DEL OBJETIVO "+l.data[0].txtobjetivo+" PARA PROYECTO CON # DE CONVENIO: "+l.convenioproyecto+" Y NOMBRE: "+l.nombreproyecto);var t="Cordial Saludo,<br><br> Se Actualizaron/Crearon Productos para el Objetivo "+l.data[0].txtobjetivo+" para el Proyecto con # de Convenio "+l.convenioproyecto+", Nombre: "+l.nombreproyecto+"<br><br>Agradeciendo su atención,<br><br> <b>SINCHI</b><br><br> <i>Este es un servicio de notificaciones generado automáticamente por medio de correo electrónico, no lo responda.</i> <br>",i="Se Actualizaron/Crearon Productos para el Objetivo "+l.data[0].txtobjetivo+" para el Proyecto con # de Convenio "+l.convenioproyecto+", Nombre: "+l.nombreproyecto;l.envioNotificaciones(i,"Actualización/Creación de Productos de Objetivos de un Proyecto",t)}else l.showMessage(!0,3e3,"error",o.message);l.loading=!1})).catch((function(o){l.showMessage(!0,3e3,"error",o),l.loading=!1}))},next:function(){this.onboarding=this.onboarding+1===this.length?0:this.onboarding+1},prev:function(){this.onboarding=this.onboarding-1<0?this.length-1:this.onboarding-1},agregaBitacora:function(o,e){var t={modulo:"PRODUCTOS PROYECTOS",accion:o,detalle:e};this.$root.$emit("agregaBitacora",t)}},watch:{proyecto:function(o){0!=o&&this.traerObjetivos(o)},onboarding:function(o){if(this.arrObjetivos.length>0)this.traerdata(this.proyecto,this.arrObjetivos[o].codigo);else for(var e=0;e<30;e++)this.data.push({codigo:e+1,descripcion:"",codigoreal:0,objetivo:objetivo,peso:0})}},mounted:function(){this.traerObjetivos(this.proyecto)},created:function(){var o=this;this.$store.watch((function(o){return o.proyobjetivos}),(function(e,t){o.traerObjetivos(o.proyecto)}))}},d=s,l=t("2877"),u=Object(l["a"])(d,i,a,!1,null,null,null);e["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d22d799.37eb44ab.js.map