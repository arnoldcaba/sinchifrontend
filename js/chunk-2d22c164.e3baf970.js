(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22c164"],{f279:function(e,r,t){"use strict";t.r(r);var o=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("v-card",[t("v-card-title",[e._v(e._s(e.menuTitle))]),t("v-card-text",[t("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(r){e.valid=r},expression:"valid"}},[t("v-text-field",{attrs:{counter:35,rules:e.titleRules,label:"Titulo",required:""},model:{value:e.titulo,callback:function(r){e.titulo=r},expression:"titulo"}}),t("v-textarea",{attrs:{rules:e.descripcionRules,label:"Descripci√≥n",counter:250,required:""},model:{value:e.descripcion,callback:function(r){e.descripcion=r},expression:"descripcion"}}),t("v-row",[t("v-col",[t("v-text-field",{attrs:{type:"date",rules:e.fechaAperturaRules,label:"Fecha Apertura",required:""},model:{value:e.fecha_apertura,callback:function(r){e.fecha_apertura=r},expression:"fecha_apertura"}})],1),t("v-col",[t("v-text-field",{attrs:{type:"time",rules:e.horaAperturaRules,label:"Hora Apertura",required:""},model:{value:e.hora_apertura,callback:function(r){e.hora_apertura=r},expression:"hora_apertura"}})],1)],1),t("v-row",[t("v-col",[t("v-text-field",{attrs:{type:"date",rules:e.fechaCierreRules,label:"Fecha Cierre",required:""},model:{value:e.fecha_cierre,callback:function(r){e.fecha_cierre=r},expression:"fecha_cierre"}})],1),t("v-col",[t("v-text-field",{attrs:{type:"time",rules:e.horaCierreRules,label:"Hora Cierre",required:""},model:{value:e.hora_cierre,callback:function(r){e.hora_cierre=r},expression:"hora_cierre"}})],1)],1),t("v-row",{attrs:{"no-gutters":""}},[t("v-file-input",{attrs:{"prepend-icon":"",multiple:"",label:"Adjuntos",placeholder:"terminos de referencia, descripciones adicionales etc",required:""},model:{value:e.files,callback:function(r){e.files=r},expression:"files"}})],1),["lista_corta","conv_publica"].includes(e.tipoContratacion)?e._e():t("div",[t("h2",[e._v("Datos Personales")]),t("v-row",[t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirNombreRules,label:"Nombre 1",required:""},model:{value:e.dirNombre1,callback:function(r){e.dirNombre1=r},expression:"dirNombre1"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirNombre2Rules,label:"Nombre 2"},model:{value:e.dirNombre2,callback:function(r){e.dirNombre2=r},expression:"dirNombre2"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirApellidoRules,label:"Apellido 1",required:""},model:{value:e.dirApellido1,callback:function(r){e.dirApellido1=r},expression:"dirApellido1"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirApellido2Rules,label:"Apellido 2"},model:{value:e.dirApellido2,callback:function(r){e.dirApellido2=r},expression:"dirApellido2"}})],1),t("v-col",{attrs:{cols:"12"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirCorreoRules,label:"Correo",required:""},model:{value:e.dirCorreo,callback:function(r){e.dirCorreo=r},expression:"dirCorreo"}})],1)],1)],1),"lista_corta"===e.tipoContratacion?t("div",[t("Proponentes",{attrs:{proponentes:e.proponentes},on:{save:e.addProponente}})],1):e._e(),t("v-row",{staticClass:"mt-5",attrs:{justify:"end","no-gutters":""}},[t("v-btn",{staticClass:"mr-4",attrs:{color:"error"},on:{click:e.reset}},[e._v("Limpiar\n        ")]),t("v-btn",{attrs:{color:"success"},on:{click:e.save}},[e._v(e._s(e.btnSave)+"\n        ")])],1)],1)],1)],1)},i=[],n=t("a34a"),a=t.n(n),s=t("ce69"),c=t("d318"),l=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.proponentes,"items-per-page":5},scopedSlots:e._u([{key:"top",fn:function(){return[t("div",{staticClass:"pa-5"},[t("v-row",{attrs:{justify:"space-between",aling:"center"}},[t("h2",[e._v("Proponentes")]),t("v-btn",{attrs:{small:"",fab:"",color:"primary"},on:{click:function(r){e.visFomr=!e.visFomr}}},[t("v-icon",{attrs:{dark:""}},[e._v("add")])],1)],1),e.visFomr?t("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(r){e.valid=r},expression:"valid"}},[t("v-row",[t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirNombreRules,label:"Nombre 1",required:""},model:{value:e.nombre1,callback:function(r){e.nombre1=r},expression:"nombre1"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirNombreRules,label:"Nombre 2"},model:{value:e.nombre2,callback:function(r){e.nombre2=r},expression:"nombre2"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirNombreRules,label:"Apellido 1",required:""},model:{value:e.apellido1,callback:function(r){e.apellido1=r},expression:"apellido1"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirNombreRules,label:"Apellido 2"},model:{value:e.apellido2,callback:function(r){e.apellido2=r},expression:"apellido2"}})],1),t("v-col",{attrs:{cols:"12"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirCorreoRules,label:"Correo",required:""},model:{value:e.correo,callback:function(r){e.correo=r},expression:"correo"}})],1)],1),t("v-row",{attrs:{justify:"end","no-gutters":""}},[t("v-btn",{staticClass:"mr-4",attrs:{color:"error"},on:{click:e.reset}},[e._v("Limpiar\n            ")]),t("v-btn",{attrs:{color:"accent"},on:{click:e.save}},[e._v(e._s(e.btnSave)+"\n            ")])],1)],1):e._e()],1)]},proxy:!0},{key:"item.action",fn:function(r){var o=r.item;return[t("v-btn",{attrs:{icon:"",color:"primary"},on:{click:function(r){return e.editProponente(o)}}},[t("v-icon",{attrs:{dark:""}},[e._v("edit\n        ")])],1),t("v-btn",{attrs:{icon:"",color:"error"},on:{click:function(r){return e.eliminar(o)}}},[t("v-icon",{attrs:{dark:""}},[e._v("delete")])],1)]}}])})],1)},u=[];function d(e,r,t,o,i,n,a){try{var s=e[n](a),c=s.value}catch(l){return void t(l)}s.done?r(c):Promise.resolve(c).then(o,i)}function p(e){return function(){var r=this,t=arguments;return new Promise((function(o,i){var n=e.apply(r,t);function a(e){d(n,o,i,a,s,"next",e)}function s(e){d(n,o,i,a,s,"throw",e)}a(void 0)}))}}var f={props:["proponentes"],data:function(){return{headers:[{text:"Nombre1",value:"nombre1",align:"center"},{text:"Nombre2",value:"nombre2",align:"center"},{text:"Apellido1",value:"apellido1",align:"center"},{text:"Apellido2",value:"apellido2",align:"center"},{text:"Email",value:"correo",align:"center"},{text:"Opciones",value:"action",align:"center"}],valid:!1,nombre1:"",nombre2:"",apellido1:"",apellido2:"",correo:"",dirNombreRules:[function(e){return!!e||"Nombre es requerido"},function(e){return e&&e.length<=35||"Nombre debe ser menor de 35 caracteres."}],dirApellidoRules:[function(e){return!!e||"Apellido es requerido"},function(e){return e&&e.length<=35||"Apellido debe ser menor de 35 caracteres."}],dirCorreoRules:[function(e){return!!e||"Correo es requerido"},function(e){return/.+@.+\..+/.test(e)||"Correo incorrecto"}],visFomr:!1,editIndex:""}},methods:{reset:function(){var e=p(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.form.reset();case 1:case"end":return e.stop()}}),e,this)})));function r(){return e.apply(this,arguments)}return r}(),save:function(){var e=p(a.a.mark((function e(){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r={index:this.editIndex,nombre1:this.nombre1.trim()?this.nombre1.toUpperCase():"",nombre2:this.nombre2.trim()?this.nombre2.toUpperCase():"",apellido1:this.apellido1.trim()?this.apellido1.toUpperCase():"",apellido2:this.apellido2.trim()?this.apellido2.toUpperCase():"",correo:this.correo},r.index||0===r.index?this.proponentes.splice(r.index,1,r):this.proponentes.unshift(r),this.editIndex="",this.visFomr=!1;case 4:case"end":return e.stop()}}),e,this)})));function r(){return e.apply(this,arguments)}return r}(),editProponente:function(e){this.editIndex=this.proponentes.indexOf(e),this.nombre1=e.nombre1,this.nombre2=e.nombre2,this.apellido1=e.apellido1,this.apellido2=e.apellido2,this.correo=e.correo,this.visFomr=!0},eliminar:function(){var e=p(a.a.mark((function e(r){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=this.proponentes.indexOf(r),this.proponentes.splice(t,1),this.editIndex="",this.visFomr=!1;case 4:case"end":return e.stop()}}),e,this)})));function r(r){return e.apply(this,arguments)}return r}()},computed:{btnSave:function(){return this.editIndex||0===this.editIndex?"Guardar":"Agregar"}}},h=f,v=t("2877"),m=Object(v["a"])(h,l,u,!1,null,null,null),b=m.exports,x=t("c1df"),_=t.n(x);function C(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function y(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?C(Object(t),!0).forEach((function(r){k(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function k(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function w(e,r,t,o,i,n,a){try{var s=e[n](a),c=s.value}catch(l){return void t(l)}s.done?r(c):Promise.resolve(c).then(o,i)}function A(e){return function(){var r=this,t=arguments;return new Promise((function(o,i){var n=e.apply(r,t);function a(e){w(n,o,i,a,s,"next",e)}function s(e){w(n,o,i,a,s,"throw",e)}a(void 0)}))}}var P={props:["selPropCont"],components:{Proponentes:b},data:function(){var e=this;return{valid:!0,titulo:"",files:[],titleRules:[function(e){return!!e||"Titulo es requerido"},function(e){return e&&e.length<=35||"Titulo debe ser menor de 35 caracteres."}],descripcion:"",descripcionRules:[function(e){return!!e||"Descripcion es requerido"},function(e){return e&&e.length<=250||"Descripcion debe ser menor de 250 caracteres."}],fecha_cierre:"",fechaCierreRules:[function(e){return!!e||"Fecha de cierre es requerido"},function(r){return e.difDays(e.fecha_apertura,r)<=0||"Fecha de cierre debe ser mayor a la fecha de apertura."}],hora_cierre:"",horaCierreRules:[function(e){return!!e||"Hora de cierre es requerido"},function(r){return!(0===e.difDays(e.fecha_apertura,e.fecha_cierre)&&r<=e.hora_apertura)||"Hora de cierre debe ser mayor a la hora de apertura."}],fecha_apertura:"",fechaAperturaRules:[function(e){return!!e||"Fecha de apertura es requerido"},function(r){return e.difDays(_()(new Date),r)<=0||"Fecha de apertura debe ser mayor a la fecha actual."}],hora_apertura:"",horaAperturaRules:[function(e){return!!e||"Hora de apertura es requerido"}],dirUsuario:"",dirUsuarioRules:[function(e){return!!e||"Usuario es requerido"},function(e){return e&&e.length<=35||"Usuario debe ser mayor de 35 caracteres."}],dirNombre1:"",dirNombre2:"",dirNombreRules:[function(e){return!!e||"Nombre es requerido"},function(e){return e&&e.length<=35||"Nombre debe ser mayor de 35 caracteres."}],dirNombre2Rules:[function(e){return e.length<=35||"Nombre debe ser mayor de 35 caracteres."}],dirApellido1:"",dirApellido2:"",dirApellidoRules:[function(e){return!!e||"Apellido es requerido"},function(e){return e&&e.length<=35||"Apellido debe ser mayor de 35 caracteres."}],dirApellido2Rules:[function(e){return e.length<=35||"Apellido debe ser mayor de 35 caracteres."}],dirCorreo:"",dirCorreoRules:[function(e){return!!e||"Correo es requerido"},function(e){return/.+@.+\..+/.test(e)||"Correo incorrecto"}],proponentes:[]}},mounted:function(){var e=A(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.selPropCont.referencia&&(this.titulo=this.selPropCont.titulo,this.descripcion=this.selPropCont.descripcion,this.fecha_cierre=this.selPropCont.fecha_cierre.slice(0,10),this.hora_cierre=this.selPropCont.fecha_cierre.slice(11,16),this.fecha_apertura=this.selPropCont.fecha_apertura.slice(0,10),this.hora_apertura=this.selPropCont.fecha_apertura.slice(11,16)),e.next=3,this.getTermRefsDetails(this.selPropCont.id_termref);case 3:case"end":return e.stop()}}),e,this)})));function r(){return e.apply(this,arguments)}return r}(),methods:{save:function(){var e=A(a.a.mark((function e(){var r,t,o,i,n,c,l,u;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$refs.form.validate()){e.next=40;break}for(r=y({},this.selPropCont),r.titulo=this.titulo,r.descripcion=this.descripcion,r.fecha_cierre=this.fecha_cierre+" "+this.hora_cierre,r.fecha_apertura=this.fecha_apertura+" "+this.hora_apertura,["lista_corta","conv_publica"].includes(this.tipoContratacion)?r.proponentes=this.proponentes:(r.nombre1=this.dirNombre1,r.nombre2=this.dirNombre2,r.apellido1=this.dirApellido1,r.apellido2=this.dirApellido2,r.correo=this.dirCorreo),t=new FormData,o=0;o<this.files.length;o++)t.append("files[i]",this.files[o]);if(t.append("titulo",this.titulo),t.append("descripcion",this.descripcion),t.append("fecha_cierre",this.fecha_cierre+" "+this.hora_cierre),t.append("fecha_apertura",this.fecha_apertura+" "+this.hora_apertura),t.append("estado",r.estado),t.append("id",r.id),t.append("tipo_contratacion",r.tipo_contratacion),["lista_corta","conv_publica"].includes(this.tipoContratacion)?t.append("proponentes",this.proponentes):(t.append("dirNombre1",this.dirNombre1),t.append("dirNombre2",this.dirNombre2),t.append("dirApellido1",this.dirApellido1),t.append("dirApellido2",this.dirApellido2),t.append("dirCorreo",this.dirCorreo)),e.prev=17,!r.referencia){e.next=27;break}return e.next=21,s["a"].editPropuestaConvocatoria(r.id,t);case 21:i=e.sent,n=i.data,console.log(n),this.$toasted.success("".concat(r.referencia," Editada!"),{icon:"done",duration:3e3}),e.next=34;break;case 27:return t.append("estado","Abierto"),r.estado="Abierto",e.next=31,s["a"].savePropuestaConvocatoria(t);case 31:c=e.sent,l=c.data,l.referencia?(u=l.referencia,r.referencia=u,this.$toasted.success("Datos guardados. Con ".concat(u,"!"),{icon:"done",duration:3e3})):this.$toasted.info("Error al generar numero de referencia.",{icon:"info",duration:3e3});case 34:e.next=40;break;case 36:e.prev=36,e.t0=e["catch"](17),console.log(e.t0),this.$toasted.error(e.t0,{icon:"error",duration:3e3});case 40:case"end":return e.stop()}}),e,this,[[17,36]])})));function r(){return e.apply(this,arguments)}return r}(),reset:function(){this.$refs.form.reset()},difDays:function(e,r){var t=_()(e),o=_()(r),i=_.a.duration(t.diff(o));return parseInt(i.asDays())},getTermRefsDetails:function(){var e=A(a.a.mark((function e(r){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c["termRef"].getTermRefDetail(r);case 3:t=e.sent,t.data,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function r(r){return e.apply(this,arguments)}return r}(),setPropfields:function(e){["lista_corta","conv_publica"].includes(this.tipoContratacion)?this.proponentes=e.proponentes:(this.dirNombre=e.nombre,this.dirCorreo=e.correo)},addProponente:function(e){e.index||0===e.index?this.proponentes.splice(e.index,1,e):this.proponentes.unshift(e)}},computed:{menuTitle:function(){return this.selPropCont.referencia?"Editar ".concat(this.selPropCont.referencia):"Generar Propuesta"},btnSave:function(){return this.selPropCont.esPropConv?"Editar":"Guardar"},tipoContratacion:function(){return this.selPropCont.tipo_contratacion}}},g=P,N=Object(v["a"])(g,o,i,!1,null,null,null);r["default"]=N.exports}}]);
//# sourceMappingURL=chunk-2d22c164.e3baf970.js.map