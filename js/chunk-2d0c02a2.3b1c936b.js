(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c02a2"],{"412a":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("h2",[t._v(t._s(t.txtTitle))]),n("div",{staticClass:"mt-5"},[n("v-select",{attrs:{items:t.tiposContratacion,label:"Tipo contración",dense:"",disabled:!!t.idPlantilla,loading:t.loading},model:{value:t.tipoContratacion,callback:function(e){t.tipoContratacion=e},expression:"tipoContratacion"}})],1),n("v-row",[n("v-col",{attrs:{cols:t.showNew?8:6}},[n("TermrefItems",{directives:[{name:"show",rawName:"v-show",value:!t.showNew&&t.tipoContratacion,expression:"!showNew && tipoContratacion"}],key:t.reset,attrs:{newTermrefItem:t.newTermrefItem,editItemList:t.editItemList,tipoContratacion:t.tipoContratacion},on:{"add-element":function(e){t.showNew=!t.showNew},"reset-termref":function(e){t.newTermrefItem=""},"edit-item":t.setEditItem}}),t.showNew?n("NewTermrefItem",{attrs:{editItem:t.editItem},on:{cancel:function(e){t.showNew=!t.showNew},save:t.saveNewTermrefItem}},[t._v("\n        >\n      ")]):t._e()],1),n("v-col",{attrs:{cols:t.showNew?4:6}},[t.tipoContratacion?n("TermrefPlantilla",{attrs:{idPlantilla:t.idPlantilla,tipoContratacion:t.tipoContratacion,editItemPlantilla:t.editItemPlantilla},on:{removed:t.removed,resetear:function(e){t.reset++},"edit-item":t.setEditItem}}):t._e()],1)],1)],1)},i=[],a=n("a34a"),o=n.n(a),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-card",[n("v-card-title",{attrs:{color:"primary",dark:""}},[n("div",[t._v("Elementos disponibles")]),n("v-spacer"),n("v-btn",{attrs:{color:"primary",small:"",fab:""},on:{click:function(e){return t.$emit("add-element")}}},[n("v-icon",[t._v("add")])],1)],1),n("v-card-text",[n("draggable",{staticStyle:{width:"100%"},attrs:{group:"tr"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1}},model:{value:t.termrefs,callback:function(e){t.termrefs=e},expression:"termrefs"}},t._l(t.termrefs,(function(e,r){return n("div",{key:r},[n("v-chip",{staticClass:"ma-2",attrs:{color:"primary","text-color":"white"},on:{dblclick:function(n){return t.setDItem(e)}}},[t._v("\n            "+t._s(e.title)+"\n          ")])],1)})),0)],1)],1)],1)},c=[],l=n("310e"),u=n.n(l),f=n("ad0e");function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){m(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(l){return void n(l)}s.done?e(c):Promise.resolve(c).then(r,i)}function v(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){h(a,r,i,o,s,"next",t)}function s(t){h(a,r,i,o,s,"throw",t)}o(void 0)}))}}var g={components:{draggable:u.a},props:["tipoContratacion","newTermrefItem","editItemList"],data:function(){return{titulo:"",cuerpo:"",dialog:!1,termrefs:[],selectedItem:"",offsetTop:0}},mounted:function(){var t=v(o.a.mark((function t(){return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),methods:{getItemsPlantilla:function(){var t=v(o.a.mark((function t(e){var n,r,i,a,s,c,l,u;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f["a"].getItemsDisp({tipoContratacion:e});case 3:if(n=t.sent,r=n.data,console.log(r),i=r,a=this.$route.params.id,!a){t.next=19;break}return t.next=11,f["a"].getDataPlantilla({id:a});case 11:s=t.sent,c=s.data,l=c.detalle.filter((function(t){return"body"===t.tipo})),console.log(l),u=i.filter((function(t){return!l.find((function(e){return t.title===e.title}))})),this.termrefs=u,t.next=20;break;case 19:this.termrefs=i;case 20:t.next=25;break;case 22:t.prev=22,t.t0=t["catch"](0),console.error(t.t0);case 25:case"end":return t.stop()}}),t,this,[[0,22]])})));function e(e){return t.apply(this,arguments)}return e}(),setDItem:function(t){this.selectedItem=t;var e=p({},t);e.from="lista",this.$emit("edit-item",e)},onScroll:function(t){this.offsetTop=t.target.scrollTop}},watch:{newTermrefItem:function(t){console.log(t),t&&(this.termrefs.push(t),this.$emit("reset-termref"))},tipoContratacion:function(t){t&&this.getItemsPlantilla(t)},editItemList:function(t){var e=this;console.log(t),t&&this.termrefs.map((function(n){n===e.selectedItem&&(console.log("founded"),n.title=t.title,n.text=t.text,n.file_name=t.file_name||"",n.file_path=t.file_path||"",n.file_size=t.file_size||"",n.file_type=t.file_type||"")}))}}},w=g,b=n("2877"),y=Object(b["a"])(w,s,c,!1,null,"658a7066",null),x=y.exports,I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-card-title",[n("v-row",{attrs:{"no-gutters":"",align:"center"}},[n("span",[n("v-icon",[t._v("edit")])],1),n("p",{ref:"namePlantilla",staticClass:"px-2 my-0",attrs:{contenteditable:""}},[t._v("Plantilla sin nombre")])])],1),n("v-card-text",[n("h3",[t._v("Cabecera")]),n("draggable",{staticStyle:{width:"100%","min-height":"50px"},attrs:{group:"tr"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},change:t.change},model:{value:t.cabecera,callback:function(e){t.cabecera=e},expression:"cabecera"}},t._l(t.cabecera,(function(e,r){return n("div",{key:r},[n("v-chip",{staticClass:"ma-2",attrs:{color:"primary","text-color":"white",close:""},on:{"click:close":function(n){return t.removeItem(e)},dblclick:function(n){return t.setDItem(e)}}},[t._v("\n          "+t._s(e.title)+"\n        ")])],1)})),0),n("v-divider"),n("h3",[t._v("Cuerpo")]),n("v-container",{staticClass:"overflow-y-auto",staticStyle:{"max-height":"300px"},attrs:{id:"scroll-target"}},[n("draggable",{staticStyle:{width:"100%","min-height":"100px"},attrs:{group:"tr"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},change:t.change},model:{value:t.termrefs,callback:function(e){t.termrefs=e},expression:"termrefs"}},t._l(t.termrefs,(function(e,r){return n("div",{key:r},[n("v-chip",{staticClass:"ma-2",attrs:{color:"primary","text-color":"white",close:""},on:{"click:close":function(n){return t.removeItem(e)},dblclick:function(n){return t.setDItem(e)}}},[t._v("\n            "+t._s(e.title)+"\n          ")])],1)})),0)],1),n("v-divider"),n("h3",[t._v("Pie de página")]),n("draggable",{staticStyle:{width:"100%","min-height":"50px"},attrs:{group:"tr"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},change:t.change},model:{value:t.pie,callback:function(e){t.pie=e},expression:"pie"}},t._l(t.pie,(function(e,r){return n("div",{key:r},[n("v-chip",{staticClass:"ma-2",attrs:{color:"primary","text-color":"white",close:""},on:{"click:close":function(n){return t.removeItem(e)},dblclick:function(n){return t.setDItem(e)}}},[t._v("\n          "+t._s(e.title)+"\n        ")])],1)})),0),n("v-row",{staticClass:"mt-3",attrs:{justify:"end","no-gutters":""}},[n("v-btn",{attrs:{loading:t.loading,color:"primary",small:"",disabled:""===t.tipoContratacion},on:{click:t.save}},[t._v(t._s(t.txtSave))])],1),n("v-dialog",{attrs:{width:"650"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5 grey lighten-2"},[t._v("\n          "+t._s(t.dItem.title)+"\n        ")]),n("v-card-text",[t._v("\n          "+t._s(t.dItem.tipo)+"\n          "+t._s(t.dItem.text)+"\n        ")])],1)],1)],1)],1)},P=[],_=n("c142"),O=n("2dfa");function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){j(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(l){return void n(l)}s.done?e(c):Promise.resolve(c).then(r,i)}function N(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){T(a,r,i,o,s,"next",t)}function s(t){T(a,r,i,o,s,"throw",t)}o(void 0)}))}}var D={props:["idPlantilla","tipoContratacion","editItemPlantilla"],components:{draggable:u.a,smallAdj:_["a"],AddFilesToStorage:O["a"]},data:function(){return{loading:!1,termrefs:[],docHead:{},docFooter:{},fileReset:0,fileResetDos:145,dItem:"",dialog:!1,cabecera:[],pie:[],selectedItem:""}},mounted:function(){this.getData()},methods:{getData:function(){var t=N(o.a.mark((function t(){var e,n;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.idPlantilla){t.next=9;break}return t.next=3,f["a"].getDataPlantilla({id:this.idPlantilla});case 3:e=t.sent,n=e.data,this.cabecera=n.detalle.filter((function(t){return"header"===t.tipo})),this.termrefs=n.detalle.filter((function(t){return"body"===t.tipo})),this.pie=n.detalle.filter((function(t){return"footer"===t.tipo})),this.$refs.namePlantilla.innerText=n.titulo;case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),save:function(){var t=N(o.a.mark((function t(){var e,n,r,i,a,s;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.$refs.namePlantilla.innerHTML,n=this.tipoContratacion,!(this.termrefs.length>0)){t.next=29;break}if(r=[].concat(this.cabecera,this.termrefs,this.pie),console.log(r),t.prev=5,"Guardar"!==this.txtSave){t.next=13;break}return t.next=9,f["a"].savePlantilla({title:e,tipoContratacion:n,data:r});case 9:i=t.sent,a=i.data,t.next=18;break;case 13:if("Editar"!==this.txtSave){t.next=18;break}return t.next=16,f["a"].editPlantilla({id:this.idPlantilla,title:e,tipoContratacion:n,data:r});case 16:s=t.sent,a=s.data;case 18:"success"===a.tipo?(this.$toasted.success(a.respuesta,{icon:"done",duration:3e3}),this.$router.push("/PlantillasTermRef")):"error"===a.tipo&&this.$toasted.error(a.respuesta,{icon:"error",duration:3e3}),t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](5),console.log(t.t0);case 24:return t.prev=24,this.loading=!1,t.finish(24);case 27:t.next=30;break;case 29:this.$toasted.error("No hay items por guardar.",{icon:"error",duration:3e3});case 30:case"end":return t.stop()}}),t,this,[[5,21,24,27]])})));function e(){return t.apply(this,arguments)}return e}(),change:function(t){if(console.log(t),t.added){var e=t.added.element;this.cabecera.map((function(t){JSON.stringify(t)===JSON.stringify(e)&&(t.tipo="header")})),this.termrefs.map((function(t){JSON.stringify(t)===JSON.stringify(e)&&(t.tipo="body")})),this.pie.map((function(t){JSON.stringify(t)===JSON.stringify(e)&&(t.tipo="footer")}))}},removeItem:function(t){var e=t.tipo;"header"===e?this.cabecera.splice(this.cabecera.indexOf(t),1):"body"===e?this.termrefs.splice(this.termrefs.indexOf(t),1):this.pie.splice(this.pie.indexOf(t),1),this.$emit("removed",t)},actAdjHead:function(t){this.docHead=t},actAdjFooter:function(t){this.docFooter=t},setDItem:function(t){this.selectedItem=t;var e=C({},t);e.from="plantillas",this.$emit("edit-item",e)}},computed:{txtSave:function(){return this.idPlantilla?"Editar":"Guardar"}},watch:{dialog:function(t){t||(this.dItem="")},editItemPlantilla:function(t){var e=this;this.termrefs.map((function(n){n===e.selectedItem&&(n.title=t.title,n.text=t.text,n.file_name=t.file_name,n.file_path=t.file_path,n.file_size=t.file_size,n.file_type=t.file_type)}))}}},S=D,$=Object(b["a"])(S,I,P,!1,null,"1187e2a9",null),E=$.exports,J=n("ca8f");function L(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(l){return void n(l)}s.done?e(c):Promise.resolve(c).then(r,i)}function F(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){L(a,r,i,o,s,"next",t)}function s(t){L(a,r,i,o,s,"throw",t)}o(void 0)}))}}var z={components:{TermrefItems:x,TermrefPlantilla:E,NewTermrefItem:function(){return n.e("chunk-e67ceb90").then(n.bind(null,"7f89"))}},data:function(){return{reset:1,showNew:!1,newTermrefItem:"",tiposContratacion:[],tipoContratacion:"",loading:!1,editItem:"",editItemPlantilla:"",editItemList:""}},mounted:function(){var t=F(o.a.mark((function t(){var e=this;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.loading=!0,Promise.all([this.getTiposContracion(),this.getData()]).then((function(t){console.log(t)})).catch((function(t){console.error(t)})).finally((function(){e.loading=!1}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{getTiposContracion:function(){var t=F(o.a.mark((function t(){var e;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,J["a"].getTiposForContratacion();case 3:e=t.sent,this.tiposContratacion=e.data.tiposContratacion,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}(),getData:function(){var t=F(o.a.mark((function t(){var e,n;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.idPlantilla){t.next=12;break}return t.prev=1,t.next=4,f["a"].getDataPlantilla({id:this.idPlantilla});case 4:e=t.sent,n=e.data,this.tipoContratacion=n.tipoContratacion,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),console.error(t.t0);case 12:case"end":return t.stop()}}),t,this,[[1,9]])})));function e(){return t.apply(this,arguments)}return e}(),saveNewTermrefItem:function(t){console.log(t),"plantillas"===t.from?this.editItemPlantilla=t:"lista"===t.from?this.editItemList=t:this.newTermrefItem=t,this.showNew=!this.showNew},removed:function(t){this.newTermrefItem=t},setEditItem:function(t){console.log(t),this.editItem=t,this.showNew=!0}},computed:{txtTitle:function(){var t=this.$route.params.id;return t?"Plantilla N° ".concat(t):"Nueva plantilla"},idPlantilla:function(){return this.$route.params.id}},watch:{showNew:function(t){t||(this.editItem="")}}},A=z,H=Object(b["a"])(A,r,i,!1,null,"7ab0118d",null);e["default"]=H.exports}}]);
//# sourceMappingURL=chunk-2d0c02a2.3b1c936b.js.map