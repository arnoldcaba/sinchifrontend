(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22c164"],{f279:function(e,r,t){"use strict";t.r(r);var o=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("v-card",[t("v-card-title",[e._v(e._s(e.menuTitle))]),t("v-card-text",[t("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(r){e.valid=r},expression:"valid"}},[t("v-text-field",{attrs:{counter:35,rules:e.titleRules,label:"Titulo",required:""},model:{value:e.titulo,callback:function(r){e.titulo=r},expression:"titulo"}}),t("v-textarea",{attrs:{rules:e.descripcionRules,label:"Descripción",counter:250,required:""},model:{value:e.descripcion,callback:function(r){e.descripcion=r},expression:"descripcion"}}),t("v-row",[t("v-col",[t("v-text-field",{attrs:{type:"date",rules:e.fechaAperturaRules,label:"Fecha Apertura",required:""},model:{value:e.fecha_apertura,callback:function(r){e.fecha_apertura=r},expression:"fecha_apertura"}})],1),t("v-col",[t("v-text-field",{attrs:{type:"time",rules:e.horaAperturaRules,label:"Hora Apertura",required:""},model:{value:e.hora_apertura,callback:function(r){e.hora_apertura=r},expression:"hora_apertura"}})],1)],1),t("v-row",[t("v-col",[t("v-text-field",{attrs:{type:"date",rules:e.fechaCierreRules,label:"Fecha Cierre",required:""},model:{value:e.fecha_cierre,callback:function(r){e.fecha_cierre=r},expression:"fecha_cierre"}})],1),t("v-col",[t("v-text-field",{attrs:{type:"time",rules:e.horaCierreRules,label:"Hora Cierre",required:""},model:{value:e.hora_cierre,callback:function(r){e.hora_cierre=r},expression:"hora_cierre"}})],1)],1),t("v-row",{attrs:{"no-gutters":""}},[t("v-file-input",{attrs:{"prepend-icon":"",multiple:"",label:"Adjuntos",placeholder:"terminos de referencia, descripciones adicionales etc",required:""},model:{value:e.files,callback:function(r){e.files=r},expression:"files"}})],1),["lista_corta","conv_publica"].includes(e.tipoContratacion)?e._e():t("div",[t("h2",[e._v("Datos Personales")]),t("v-row",[t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirNombreRules,label:"Nombre 1",required:""},model:{value:e.dirNombre1,callback:function(r){e.dirNombre1=r},expression:"dirNombre1"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirNombre2Rules,label:"Nombre 2"},model:{value:e.dirNombre2,callback:function(r){e.dirNombre2=r},expression:"dirNombre2"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirApellidoRules,label:"Apellido 1",required:""},model:{value:e.dirApellido1,callback:function(r){e.dirApellido1=r},expression:"dirApellido1"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirApellido2Rules,label:"Apellido 2"},model:{value:e.dirApellido2,callback:function(r){e.dirApellido2=r},expression:"dirApellido2"}})],1),t("v-col",{attrs:{cols:"12"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirCorreoRules,label:"Correo",required:""},model:{value:e.dirCorreo,callback:function(r){e.dirCorreo=r},expression:"dirCorreo"}})],1)],1)],1),"lista_corta"===e.tipoContratacion?t("div",[t("Proponentes",{attrs:{loading:e.proponentesLoading,addProponentes:!1,proponentes:e.proponentes},on:{save:e.addProponente}})],1):e._e(),t("v-row",{staticClass:"mt-5",attrs:{justify:"end","no-gutters":""}},[t("v-btn",{staticClass:"mr-4",attrs:{color:"error"},on:{click:e.reset}},[e._v("Limpiar\n        ")]),t("v-btn",{attrs:{color:"success"},on:{click:e.save}},[e._v(e._s(e.btnSave)+"\n        ")])],1)],1),t("v-dialog",{attrs:{persistent:"",width:"300"},model:{value:e.dialogSaving,callback:function(r){e.dialogSaving=r},expression:"dialogSaving"}},[t("v-card",{attrs:{color:"primary",dark:""}},[t("v-card-text",[e._v("\n          Cargando...\n          "),t("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)],1)},i=[],n=t("a34a"),a=t.n(n),c=t("ce69"),s=t("d318"),l=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("div",{staticClass:"pa-5"},[t("v-row",{attrs:{justify:"space-between",aling:"center"}},[t("h2",[e._v("Proponentes")]),e.addProponentes?t("v-btn",{attrs:{small:"",fab:"",color:"primary"},on:{click:function(r){e.visibleForm=!e.visibleForm}}},[e.visibleForm?e._e():t("v-icon",{attrs:{dark:""}},[e._v("add")]),e.visibleForm?t("v-icon",{attrs:{dark:""}},[e._v("close")]):e._e()],1):e._e()],1),e.visibleForm?t("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(r){e.valid=r},expression:"valid"}},[t("v-row",[t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirNombreRules,label:"Nombre",required:""},model:{value:e.propSelected.nombre,callback:function(r){e.$set(e.propSelected,"nombre",r)},expression:"propSelected.nombre"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.direccionRules,label:"Dirección"},model:{value:e.propSelected.direccion,callback:function(r){e.$set(e.propSelected,"direccion",r)},expression:"propSelected.direccion"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.telFijoRules,label:"Telefono Fijo"},model:{value:e.propSelected.telFijo,callback:function(r){e.$set(e.propSelected,"telFijo",r)},expression:"propSelected.telFijo"}})],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{counter:35,rules:e.telCelularRules,label:"Telefono Movil"},model:{value:e.propSelected.telCelular,callback:function(r){e.$set(e.propSelected,"telCelular",r)},expression:"propSelected.telCelular"}})],1),t("v-col",{attrs:{cols:"12"}},[t("v-text-field",{attrs:{counter:35,rules:e.dirCorreoRules,label:"Correo",required:""},model:{value:e.propSelected.correo,callback:function(r){e.$set(e.propSelected,"correo",r)},expression:"propSelected.correo"}})],1)],1),t("v-row",{attrs:{justify:"end","no-gutters":""}},[e.propSelected.id?t("v-btn",{attrs:{color:"error"},on:{click:e.cancel}},[e._v("volver\n        ")]):e._e(),e.propSelected.id?e._e():t("v-btn",{staticClass:"mr-4",attrs:{color:"error"},on:{click:e.reset}},[e._v("Limpiar\n        ")]),e.propSelected.id?e._e():t("v-btn",{attrs:{color:"accent"},on:{click:e.save}},[e._v(e._s(e.btnSave)+"\n        ")])],1)],1):e._e()],1),e.visibleForm?e._e():t("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.proponentes,"items-per-page":5,loading:e.loading},scopedSlots:e._u([{key:"item.action",fn:function(r){var o=r.item;return[t("v-btn",{attrs:{icon:"",color:"primary"},on:{click:function(r){return e.editProponente(o)}}},[t("v-icon",{attrs:{dark:""}},[e._v("edit\n        ")])],1),t("v-btn",{attrs:{icon:"",color:"error"},on:{click:function(r){return e.eliminar(o)}}},[t("v-icon",{attrs:{dark:""}},[e._v("delete")])],1)]}}],null,!1,3452226115)})],1)},u=[];function d(e,r,t,o,i,n,a){try{var c=e[n](a),s=c.value}catch(l){return void t(l)}c.done?r(s):Promise.resolve(s).then(o,i)}function p(e){return function(){var r=this,t=arguments;return new Promise((function(o,i){var n=e.apply(r,t);function a(e){d(n,o,i,a,c,"next",e)}function c(e){d(n,o,i,a,c,"throw",e)}a(void 0)}))}}var f={props:{proponentes:{type:Array,default:[]},addProponentes:{type:Boolean,default:!0},loading:{type:Boolean,default:!1}},data:function(){return{headers:[{text:"Nombre",value:"nombre",align:"center"},{text:"Dirección",value:"direccion",align:"center"},{text:"Telefono Fijo",value:"telFijo",align:"center"},{text:"Telefono Movil",value:"telCelular",align:"center"},{text:"Email",value:"correo",align:"center"},{text:"Opciones",value:"action",align:"center"}],valid:!0,propSelected:{id:"",nombre:"",direccion:"",telFijo:"",telCelular:"",correo:""},dirNombreRules:[function(e){return!!e||"Nombre es requerido"},function(e){return e&&e.length<=35||"Nombre debe ser menor de 35 caracteres."}],direccionRules:[function(e){return!!e||"Dirección es requerido"},function(e){return e&&e.length>=10||"Dirección debe ser mayor a 10 caracteres."}],telFijoRules:[function(e){return e&&e.length>=7||"Debe ser de 7 o mas caracteres."},function(e){return/^\d+$(\.\d+)?/.test(e)||"Debe ser solo numerico."}],telCelularRules:[function(e){return e&&/3([0-9]{9})/.test(e)||"Celular no cumple el formato."}],dirCorreoRules:[function(e){return!!e||"Correo es requerido"},function(e){return/.+@.+\..+/.test(e)||"Correo incorrecto"}],visibleForm:!1}},methods:{reset:function(){var e=p(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.form.reset();case 1:case"end":return e.stop()}}),e,this)})));function r(){return e.apply(this,arguments)}return r}(),cancel:function(){this.visibleForm=!1},save:function(){var e=p(a.a.mark((function e(){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.form.validate()&&(r=this.propSelected,r.id||this.proponentes.unshift(r),this.visibleForm=!1);case 1:case"end":return e.stop()}}),e,this)})));function r(){return e.apply(this,arguments)}return r}(),editProponente:function(e){this.propSelected=e,this.visibleForm=!0},eliminar:function(){var e=p(a.a.mark((function e(r){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=this.proponentes.indexOf(r),this.proponentes.splice(t,1),this.visibleForm=!1;case 3:case"end":return e.stop()}}),e,this)})));function r(r){return e.apply(this,arguments)}return r}()},computed:{btnSave:function(){return this.propSelected.id?"Actualizar":"Agregar"}}},v=f,h=t("2877"),m=Object(h["a"])(v,l,u,!1,null,null,null),b=m.exports,_=t("c1df"),x=t.n(_);function g(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function C(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?g(Object(t),!0).forEach((function(r){y(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function y(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function k(e,r,t,o,i,n,a){try{var c=e[n](a),s=c.value}catch(l){return void t(l)}c.done?r(s):Promise.resolve(s).then(o,i)}function w(e){return function(){var r=this,t=arguments;return new Promise((function(o,i){var n=e.apply(r,t);function a(e){k(n,o,i,a,c,"next",e)}function c(e){k(n,o,i,a,c,"throw",e)}a(void 0)}))}}var P={props:["selPropCont"],components:{Proponentes:b},data:function(){var e=this;return{valid:!0,titulo:"",files:[],proponentesLoading:!1,titleRules:[function(e){return!!e||"Titulo es requerido"},function(e){return e&&e.length<=35||"Titulo debe ser menor de 35 caracteres."}],descripcion:"",descripcionRules:[function(e){return!!e||"Descripcion es requerido"},function(e){return e&&e.length<=250||"Descripcion debe ser menor de 250 caracteres."}],fecha_cierre:"",fechaCierreRules:[function(e){return!!e||"Fecha de cierre es requerido"},function(r){return e.difDays(e.fecha_apertura,r)<=0||"Fecha de cierre debe ser mayor a la fecha de apertura."}],hora_cierre:"",horaCierreRules:[function(e){return!!e||"Hora de cierre es requerido"},function(r){return!(0===e.difDays(e.fecha_apertura,e.fecha_cierre)&&r<=e.hora_apertura)||"Hora de cierre debe ser mayor a la hora de apertura."}],fecha_apertura:"",fechaAperturaRules:[function(e){return!!e||"Fecha de apertura es requerido"},function(r){return e.difDays(x()(new Date),r)<=0||"Fecha de apertura debe ser mayor a la fecha actual."}],hora_apertura:"",horaAperturaRules:[function(e){return!!e||"Hora de apertura es requerido"}],dirUsuario:"",dirUsuarioRules:[function(e){return!!e||"Usuario es requerido"},function(e){return e&&e.length<=35||"Usuario debe ser mayor de 35 caracteres."}],dirNombre1:"",dirNombre2:"",dirNombreRules:[function(e){return!!e||"Nombre es requerido"},function(e){return e&&e.length<=35||"Nombre debe ser mayor de 35 caracteres."}],dirNombre2Rules:[function(e){return e.length<=35||"Nombre debe ser mayor de 35 caracteres."}],dirApellido1:"",dirApellido2:"",dirApellidoRules:[function(e){return!!e||"Apellido es requerido"},function(e){return e&&e.length<=35||"Apellido debe ser mayor de 35 caracteres."}],dirApellido2Rules:[function(e){return e.length<=35||"Apellido debe ser mayor de 35 caracteres."}],dirCorreo:"",dirCorreoRules:[function(e){return!!e||"Correo es requerido"},function(e){return/.+@.+\..+/.test(e)||"Correo incorrecto"}],proponentes:[],dialogSaving:!1}},mounted:function(){var e=w(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.selPropCont.referencia&&(this.titulo=this.selPropCont.titulo,this.descripcion=this.selPropCont.descripcion,this.fecha_cierre=this.selPropCont.fecha_cierre.slice(0,10),this.hora_cierre=this.selPropCont.fecha_cierre.slice(11,16),this.fecha_apertura=this.selPropCont.fecha_apertura.slice(0,10),this.hora_apertura=this.selPropCont.fecha_apertura.slice(11,16)),e.next=3,this.getTermRefsDetails(this.selPropCont.id_termref);case 3:case"end":return e.stop()}}),e,this)})));function r(){return e.apply(this,arguments)}return r}(),methods:{save:function(){var e=w(a.a.mark((function e(){var r,t,o,i,n,s,l,u;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$refs.form.validate()){e.next=44;break}for(r=C({},this.selPropCont),r.titulo=this.titulo,r.descripcion=this.descripcion,r.fecha_cierre=this.fecha_cierre+" "+this.hora_cierre,r.fecha_apertura=this.fecha_apertura+" "+this.hora_apertura,["lista_corta","conv_publica"].includes(this.tipoContratacion)?r.proponentes=this.proponentes:(r.nombre1=this.dirNombre1,r.nombre2=this.dirNombre2,r.apellido1=this.dirApellido1,r.apellido2=this.dirApellido2,r.correo=this.dirCorreo),t=new FormData,o=0;o<this.files.length;o++)t.append("files[i]",this.files[o]);if(t.append("titulo",this.titulo),t.append("descripcion",this.descripcion),t.append("fecha_cierre",this.fecha_cierre+" "+this.hora_cierre),t.append("fecha_apertura",this.fecha_apertura+" "+this.hora_apertura),t.append("estado",r.estado),t.append("id",r.id),t.append("tipo_contratacion",r.tipo_contratacion),["lista_corta","conv_publica"].includes(this.tipoContratacion)?t.append("proponentes",JSON.stringify(this.proponentes)):(t.append("dirNombre1",this.dirNombre1),t.append("dirNombre2",this.dirNombre2),t.append("dirApellido1",this.dirApellido1),t.append("dirApellido2",this.dirApellido2),t.append("dirCorreo",this.dirCorreo)),this.dialogSaving=!0,e.prev=18,!r.referencia){e.next=29;break}return e.next=22,c["a"].editPropuestaConvocatoria(r.id,t);case 22:i=e.sent,n=i.data,console.log(n),this.$toasted.success("".concat(r.referencia," Editada!"),{icon:"done",duration:3e3}),this.$emit("saved",r),e.next=37;break;case 29:return t.append("estado","Abierto"),r.estado="Abierto",e.next=33,c["a"].savePropuestaConvocatoria(t);case 33:s=e.sent,l=s.data,console.log(l),l.referencia?(u=l.referencia,r.referencia=u,this.$toasted.success("Datos guardados. Con ".concat(u,"!"),{icon:"done",duration:3e3}),this.$emit("saved",r)):this.$toasted.info("Error al crear convocatoria.",{icon:"info",duration:3e3});case 37:e.next=43;break;case 39:e.prev=39,e.t0=e["catch"](18),console.log(e.t0),this.$toasted.error(e.t0,{icon:"error",duration:3e3});case 43:this.dialogSaving=!1;case 44:case"end":return e.stop()}}),e,this,[[18,39]])})));function r(){return e.apply(this,arguments)}return r}(),reset:function(){this.$refs.form.reset()},difDays:function(e,r){var t=x()(e),o=x()(r),i=x.a.duration(t.diff(o));return parseInt(i.asDays())},getTermRefsDetails:function(){var e=w(a.a.mark((function e(r){var t,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.proponentesLoading=!0,e.prev=1,e.next=4,s["termRef"].getTermRefDetail(r);case 4:t=e.sent,o=t.data,this.setPropfields(o),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),console.log(e.t0);case 12:this.proponentesLoading=!1;case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));function r(r){return e.apply(this,arguments)}return r}(),setPropfields:function(e){["lista_corta","conv_publica"].includes(this.tipoContratacion)?this.proponentes=e.proponentes.map((function(e){return e.nombre=e.nombre.toUpperCase(),e.direccion=e.direccion.toUpperCase(),e})):(this.dirNombre=e.nombre,this.dirCorreo=e.correo)},addProponente:function(e){e.index||0===e.index?this.proponentes.splice(e.index,1,e):this.proponentes.unshift(e)}},computed:{menuTitle:function(){return this.selPropCont.referencia?"Editar ".concat(this.selPropCont.referencia):"Generar Propuesta"},btnSave:function(){return this.selPropCont.referencia?"Actualizar":"Guardar"},tipoContratacion:function(){return this.selPropCont.tipo_contratacion}}},R=P,A=Object(h["a"])(R,o,i,!1,null,null,null);r["default"]=A.exports}}]);
//# sourceMappingURL=chunk-2d22c164.a1b3ff4a.js.map